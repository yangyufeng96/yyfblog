<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  
  <title>vue面试题（1） | 峰享会</title>
  
  <meta name="keywords" content="前端开发,科技,数据可视化,移动开发,小程序,客户端">
  
  
  <meta name="description" content="集合了开发技能，生活趣事，未来科技，情感互动于一体。">
  

  
  <link rel="alternate" href="/./atom.xml" title="峰享会">
  

  <meta name="HandheldFriendly" content="True">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <!-- meta -->
  
  
  <meta name="theme-color" content="#FFFFFF">
  <meta name="msapplication-TileColor" content="#1BC3FB">
  

  <!-- link -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css">
  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-waves@0.7.6/dist/waves.min.css">
  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.6.3/css/all.min.css">
  
  
  <link rel="shortcut icon" type="image/x-icon" href="https://cdn.jsdelivr.net/gh/yangyfeng/yangyfeng.github.io@gh-pages/assets_blog/img/favicon.ico">
  

  

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/yangyfeng/yangyfeng.github.io@gh-pages/assets_blog/css/style.css">
  

  <script>
    function setLoadingBarProgress(num) {
      document.getElementById('loading-bar').style.width=num+"%";
    }
  </script>

  
  
</head>

<body>
  
  
  <div class="cover-wrapper">
    <cover class='cover post half'>
      
        
  <h1 class='title'>路漫漫而上下求索</h1>


  <div class="m_search">
    <form name="searchform" class="form u-search-form">
      <input type="text" class="input u-search-input" placeholder="这里有你知道的一切" />
      <i class="icon fas fa-search fa-fw"></i>
    </form>
  </div>

<div class='menu navgation'>
  <ul class='h-list'>
    
      
        <li>
          <a class="nav home" href="/"
            
            
            id="home">
            <i class='fas fa-home fa-fw'></i>&nbsp;主页
          </a>
        </li>
      
        <li>
          <a class="nav home" href="/blogpost/categories/"
            
              rel="nofollow"
            
            
            id="blogpostcategories">
            <i class='fas fa-folder-open fa-fw'></i>&nbsp;分类
          </a>
        </li>
      
        <li>
          <a class="nav home" href="/blogpost/tags/"
            
              rel="nofollow"
            
            
            id="blogposttags">
            <i class='fas fa-hashtag fa-fw'></i>&nbsp;标签
          </a>
        </li>
      
        <li>
          <a class="nav home" href="/blogpost/archives/"
            
              rel="nofollow"
            
            
            id="blogpostarchives">
            <i class='fas fa-archive fa-fw'></i>&nbsp;归档
          </a>
        </li>
      
        <li>
          <a class="nav home" href="/friends/"
            
              rel="nofollow"
            
            
            id="friends">
            <i class='fas fa-user-friends fa-fw'></i>&nbsp;朋友
          </a>
        </li>
      
        <li>
          <a class="nav home" href="/about/"
            
              rel="nofollow"
            
            
            id="about">
            <i class='fas fa-info-circle fa-fw'></i>&nbsp;关于
          </a>
        </li>
      
        <li>
          <a class="nav home" href="http://www.bejson.com/"
            
              rel="nofollow"
            
            
              target="_blank"
            
            id="http:www.bejson.com">
            <i class='fas fa-toolbox fa-fw'></i>&nbsp;工具箱
          </a>
        </li>
      
    
  </ul>
</div>

      
    </cover>
    <header class="l_header material">
  <div id="loading-bar-wrapper">
    <div id="loading-bar" class="material"></div>
  </div>

	<div class='wrapper'>
		<div class="nav-main container container--flex">
      <a class="logo flat-box" href='/' >
        
          峰享会
        
      </a>
			<div class='menu navgation'>
				<ul class='h-list'>
          
  					
  						<li>
								<a class="nav flat-box" href="/"
                  
                  
                  id="home">
									<i class='fas fa-home fa-fw'></i>&nbsp;主页
								</a>
							</li>
      			
  						<li>
								<a class="nav flat-box" href="/blogpost/categories/"
                  
                    rel="nofollow"
                  
                  
                  id="blogpostcategories">
									<i class='fas fa-folder-open fa-fw'></i>&nbsp;分类
								</a>
							</li>
      			
  						<li>
								<a class="nav flat-box" href="/blogpost/tags/"
                  
                    rel="nofollow"
                  
                  
                  id="blogposttags">
									<i class='fas fa-hashtag fa-fw'></i>&nbsp;标签
								</a>
							</li>
      			
  						<li>
								<a class="nav flat-box" href="/blogpost/archives/"
                  
                    rel="nofollow"
                  
                  
                  id="blogpostarchives">
									<i class='fas fa-archive fa-fw'></i>&nbsp;归档
								</a>
							</li>
      			
  						<li>
								<a class="nav flat-box" href="/friends/"
                  
                    rel="nofollow"
                  
                  
                  id="friends">
									<i class='fas fa-user-friends fa-fw'></i>&nbsp;朋友
								</a>
							</li>
      			
  						<li>
								<a class="nav flat-box" href="/about/"
                  
                    rel="nofollow"
                  
                  
                  id="about">
									<i class='fas fa-info-circle fa-fw'></i>&nbsp;关于
								</a>
							</li>
      			
      		
				</ul>
			</div>

			
				<div class="m_search">
					<form name="searchform" class="form u-search-form">
						<input type="text" class="input u-search-input" placeholder="搜索" />
						<i class="icon fas fa-search fa-fw"></i>
					</form>
				</div>
			
			<ul class='switcher h-list'>
				
					<li class='s-search'><a class="fas fa-search fa-fw" href='javascript:void(0)'></a></li>
				
				<li class='s-menu'><a class="fas fa-bars fa-fw" href='javascript:void(0)'></a></li>
			</ul>
		</div>

		<div class='nav-sub container container--flex'>
			<a class="logo flat-box"></a>
			<ul class='switcher h-list'>
				<li class='s-comment'><a class="flat-btn fas fa-comments fa-fw" href='javascript:void(0)'></a></li>
        
          <li class='s-toc'><a class="flat-btn fas fa-list fa-fw" href='javascript:void(0)'></a></li>
        
			</ul>
		</div>
	</div>
</header>
	<aside class="menu-phone">
    <header>
		<nav class="menu navgation">
      <ul>
        
          
            <li>
							<a class="nav flat-box" href="/"
                
                
                id="home">
								<i class='fas fa-clock fa-fw'></i>&nbsp;所有文章
							</a>
            </li>
          
            <li>
							<a class="nav flat-box" href="/blogpost/archives/"
                
                  rel="nofollow"
                
                
                id="blogpostarchives">
								<i class='fas fa-archive fa-fw'></i>&nbsp;文章归档
							</a>
            </li>
          
            <li>
							<a class="nav flat-box" href="/blogpost/tags/"
                
                  rel="nofollow"
                
                
                id="blogposttags">
								<i class='fas fa-hashtag fa-fw'></i>&nbsp;所有标签
							</a>
            </li>
          
            <li>
							<a class="nav flat-box" href="/friends/"
                
                  rel="nofollow"
                
                
                id="friends">
								<i class='fas fa-link fa-fw'></i>&nbsp;我的友链
							</a>
            </li>
          
            <li>
							<a class="nav flat-box" href="/./atom.xml"
                
                  rel="nofollow"
                
                
                id=".atom.xml">
								<i class='fas fa-rss fa-fw'></i>&nbsp;RSS订阅
							</a>
            </li>
          
            <li>
							<a class="nav flat-box" href="/about/"
                
                  rel="nofollow"
                
                
                id="about">
								<i class='fas fa-info-circle fa-fw'></i>&nbsp;关于博主
							</a>
            </li>
          
       
      </ul>
		</nav>
    </header>
	</aside>
<script>setLoadingBarProgress(40);</script>

  </div>

  <div class="l_body">
    <div class='body-wrapper'>
      <div class='l_main'>
  

  
    <article id="post" class="post white-box article-type-post" itemscope itemprop="blogPost">
      


  <section class='meta'>
    
    
    <div class="meta" id="header-meta">
      
        
  
    <h1 class="title">
      <a href="/posts/f0a558a1.html">
        vue面试题（1）
      </a>
    </h1>
  


      
      <div class='new-meta-box'>
        
          
        
          
            
  <div class='new-meta-item author'>
    <a href="https://yangyfeng.github.io" rel="nofollow">
      
        <img src="https://s2.ax1x.com/2019/07/12/Zhm4jf.jpg">
      
      <p>漫道求索</p>
    </a>
  </div>


          
        
          
            <div class="new-meta-item date">
  <a class='notlink'>
    <i class="fas fa-calendar-alt" aria-hidden="true"></i>
    <p>2020-12-11</p>
  </a>
</div>

          
        
          
            
  
  <div class='new-meta-item category'>
    <a href='/blogpost/categories/前端/' rel="nofollow">
      <i class="fas fa-folder-open" aria-hidden="true"></i>
      <p>前端</p>
    </a>
  </div>


          
        
          
            
  
    <div class="new-meta-item browse busuanzi">
      <a class='notlink'>
        <i class="fas fa-eye" aria-hidden="true"></i>
        <p>
          <span id="busuanzi_value_page_pv">
            <i class="fas fa-spinner fa-spin fa-fw" aria-hidden="true"></i>
          </span>
        </p>
      </a>
    </div>
  


          
        
          
            

          
        
        
          <!-- 文章字体个数 -->
          <div class="new-meta-item size">
            <a class="notlink">
              <i class="fas fa-edit" aria-hidden="true"></i>
              <p>4.9k字</p>
            </a>
          </div>
          <!-- 阅读时间 -->
          <div class="new-meta-item read-time">
            <a class="notlink">
              <i class="fas fa-desktop" aria-hidden="true"></i>
              <p>21分</p>
            </a>
          </div>
        
      </div>
      
        <hr>
      
    </div>
  </section>


      <section class="article typo">
        <div class="article-entry" itemprop="articleBody">
          <h2 id="Vue双向绑定实现原理？"><a href="#Vue双向绑定实现原理？" class="headerlink" title="Vue双向绑定实现原理？"></a>Vue双向绑定实现原理？</h2><p>vue实现数据双向绑定主要是：采用数据劫持结合发布者-订阅者模式的方式，通过 Object.defineProperty() 来劫持各个属性的setter，getter，在数据变动时发布消息给订阅者，触发相应监听回调。当把一个普通 Javascript 对象传给 Vue 实例来作为它的 data 选项时，Vue 将遍历它的属性，用 Object.defineProperty() 将它们转为 getter/setter。用户看不到 getter/setter，但是在内部它们让 Vue 追踪依赖，在属性被访问和修改时通知变化。</p>
<p>vue的数据双向绑定 将MVVM作为数据绑定的入口，整合Observer，Compile和Watcher三者，通过Observer来监听自己的model的数据变化，通过Compile来解析编译模板指令（vue中是用来解析 双花括弧），最终利用watcher搭起observer和Compile之间的通信桥梁，达到数据变化 —&gt;视图更新；视图交互变化（input）—&gt;数据model变更双向绑定效果。</p>
<ul>
<li>Observer 对所有数据的属性进行监听</li>
<li>Compile 对每个元素节点的指令进行扫描跟解析,根据指令模板替换数据,以及绑定相应的更新函数</li>
<li>Watcher 作为连接Observer 跟 Compile 之间的桥梁, 能够订阅接收到每个属性变动的通知,执行相应的回调函数</li>
</ul>
<p>代码理解: </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> Dep = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.subs = []</span><br><span class="line">&#125;;</span><br><span class="line">Dep.prototype = &#123;</span><br><span class="line">  addSub: <span class="function"><span class="keyword">function</span>(<span class="params">sub</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.subs.push(sub)</span><br><span class="line">  &#125;,</span><br><span class="line">  notify: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.subs.forEach(sub = &gt; &#123;</span><br><span class="line">      sub.update()</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">const</span> Watcher = <span class="function"><span class="keyword">function</span>(<span class="params">vm, node, name</span>) </span>&#123;</span><br><span class="line">  Dep.target = <span class="keyword">this</span>;</span><br><span class="line">  <span class="keyword">this</span>.name = name;</span><br><span class="line">  <span class="keyword">this</span>.node = node;</span><br><span class="line">  <span class="keyword">this</span>.vm = vm;</span><br><span class="line">  <span class="keyword">this</span>.update();</span><br><span class="line">  Dep.target = <span class="literal">null</span></span><br><span class="line">&#125;;</span><br><span class="line">Watcher.prototype = &#123;</span><br><span class="line">  update: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.get();</span><br><span class="line">    <span class="keyword">this</span>.node.nodeValue = <span class="keyword">this</span>.value</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="keyword">get</span>: function() &#123;</span><br><span class="line">    <span class="keyword">this</span>.value = <span class="keyword">this</span>.vm[<span class="keyword">this</span>.name]</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">const</span> compile = <span class="function"><span class="keyword">function</span>(<span class="params">node, vm</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (node.nodeType === <span class="number">1</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> attr = node.attributes;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; attr.length; i++) &#123;</span><br><span class="line">      <span class="keyword">if</span> (attr[i].nodeName === <span class="string">'v-model'</span>) &#123;</span><br><span class="line">        <span class="keyword">let</span> name = attr[i].nodeValue;</span><br><span class="line">        node.addEventListener(<span class="string">'input'</span>, e = &gt; &#123;</span><br><span class="line">          vm[name] = node.value</span><br><span class="line">        &#125;);</span><br><span class="line">        node.value = vm[name];</span><br><span class="line">        node.removeAttribute(<span class="string">'v-model'</span>)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (node.nodeType === <span class="number">3</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="regexp">/\&#123;\&#123;(.*)\&#125;\&#125;/</span>.test(node.nodeValue)) &#123;</span><br><span class="line">      <span class="keyword">let</span> name = <span class="built_in">RegExp</span>.$<span class="number">1</span>;</span><br><span class="line">      name = name.trim();</span><br><span class="line">      node.nodeValue = vm[name];</span><br><span class="line">      <span class="keyword">new</span> Watcher(vm, node, name)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">const</span> observe = data = &gt; &#123;</span><br><span class="line">  <span class="keyword">if</span> (!data || <span class="keyword">typeof</span> data !== <span class="string">'object'</span>) <span class="keyword">return</span> <span class="number">3344</span>;</span><br><span class="line">  <span class="built_in">Object</span>.keys(data).forEach(key = &gt; defineReactive(data, key, data[key]))</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">const</span> defineReactive = (data, key, value) = &gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> dep = <span class="keyword">new</span> Dep();</span><br><span class="line">  observe(value);</span><br><span class="line">  <span class="built_in">Object</span>.defineProperty(data, key, &#123;</span><br><span class="line">    <span class="keyword">get</span>: () = &gt; &#123;</span><br><span class="line">      <span class="keyword">if</span> (Dep.target) dep.addSub(Dep.target);</span><br><span class="line">      <span class="keyword">return</span> value</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="keyword">set</span>: function(newValue) &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">`数据已发生变化，新的值为$ &#123;</span></span><br><span class="line"><span class="string">				newValue</span></span><br><span class="line"><span class="string">			&#125;`</span>);</span><br><span class="line">      value = newValue;</span><br><span class="line">      dep.notify()</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">nodeToFragment</span>(<span class="params">node, vm</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> flag = <span class="built_in">document</span>.createDocumentFragment();</span><br><span class="line">  <span class="keyword">let</span> child;</span><br><span class="line">  <span class="keyword">while</span> ((child = node.firstChild)) &#123;</span><br><span class="line">    compile(child, vm);</span><br><span class="line">    flag.appendChild(child)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> flag</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Vue</span>(<span class="params">options</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> data = <span class="keyword">this</span>.data = options.data;</span><br><span class="line">  observe(data, <span class="keyword">this</span>);</span><br><span class="line">  <span class="keyword">let</span> id = options.el;</span><br><span class="line">  <span class="keyword">let</span> dom = nodeToFragment(<span class="built_in">document</span>.getElementById(id), data);</span><br><span class="line">  <span class="built_in">document</span>.getElementById(id).appendChild(dom)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> vm = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">  el: <span class="string">'app'</span>,</span><br><span class="line">  data: &#123;</span><br><span class="line">    text: <span class="string">'example text'</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p> 题目分析：双向绑定是vue的特色之一，开发中必然会用到的知识点，然而此题还问了实现原理，升级为深度考查。 </p>
<p>思路分析：3w1h</p>
<ol>
<li>给出双绑定义</li>
<li>双绑带来的好处</li>
<li>在哪使用双绑</li>
<li>使用方式</li>
<li>扩展：使用细节、原理实现描述</li>
</ol>
<p>回答范例：</p>
<ol>
<li>vue中双向绑定是一个指令v-model，可以绑定一个动态值到视图，同时视图中变化能改变该值。v-model是语法糖，默认情况下相当于:value和@input。</li>
<li>使用v-model可以减少大量繁琐的事件处理代码，提高开发效率，代码可读性也更好</li>
<li>通常在表单项上使用v-model</li>
<li>原生的表单项可以直接使用v-model，自定义组件上如果要使用它需要在组件内绑定value并处理输入事件</li>
<li>我做过测试，输出包含v-model模板的组件渲染函数，发现它会被转换为value属性的绑定以及一个事件监听，事件回调函数中会做相应变量更新操作，这说明神奇魔法实际上是vue的编译器完成的。</li>
</ol>
<p>可能的追问：</p>
<ol>
<li>v-model和sync修饰符有什么区别</li>
<li><p>自定义组件使用v-model如果想要改变事件名或者属性名应该怎么做</p>
<p>观察输出的渲染函数： </p>
</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// &lt;input type="text" v-model="foo"&gt;</span></span><br><span class="line">_c(<span class="string">'input'</span>, &#123; </span><br><span class="line">  directives: [&#123; <span class="attr">name</span>: <span class="string">"model"</span>, <span class="attr">rawName</span>: <span class="string">"v-model"</span>, <span class="attr">value</span>: (foo), <span class="attr">expression</span>: <span class="string">"foo"</span> &#125;], </span><br><span class="line">  attrs: &#123; <span class="string">"type"</span>: <span class="string">"text"</span> &#125;, </span><br><span class="line">  domProps: &#123; <span class="string">"value"</span>: (foo) &#125;, </span><br><span class="line">  on: &#123; </span><br><span class="line">    <span class="string">"input"</span>: <span class="function"><span class="keyword">function</span> (<span class="params">$event</span>) </span>&#123; </span><br><span class="line">      <span class="keyword">if</span> ($event.target.composing) <span class="keyword">return</span>; </span><br><span class="line">      foo = $event.target.value </span><br><span class="line">    &#125; </span><br><span class="line">  &#125; </span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// &lt;input type="checkbox" v-model="bar"&gt;</span></span><br><span class="line">_c(<span class="string">'input'</span>, &#123; </span><br><span class="line">  directives: [&#123; <span class="attr">name</span>: <span class="string">"model"</span>, <span class="attr">rawName</span>: <span class="string">"v-model"</span>, <span class="attr">value</span>: (bar), <span class="attr">expression</span>: <span class="string">"bar"</span> &#125;], </span><br><span class="line">  attrs: &#123; <span class="string">"type"</span>: <span class="string">"checkbox"</span> &#125;, </span><br><span class="line">  domProps: &#123; </span><br><span class="line">    <span class="string">"checked"</span>: <span class="built_in">Array</span>.isArray(bar) ? _i(bar, <span class="literal">null</span>) &gt; <span class="number">-1</span> : (bar) </span><br><span class="line">  &#125;, </span><br><span class="line">  on: &#123; </span><br><span class="line">    <span class="string">"change"</span>: <span class="function"><span class="keyword">function</span> (<span class="params">$event</span>) </span>&#123; </span><br><span class="line">      <span class="keyword">var</span> $$a = bar, $$el = $event.target, $$c = $$el.checked ? (<span class="literal">true</span>) : (<span class="literal">false</span>); </span><br><span class="line">      <span class="keyword">if</span> (<span class="built_in">Array</span>.isArray($$a)) &#123; </span><br><span class="line">        <span class="keyword">var</span> $$v = <span class="literal">null</span>, $$i = _i($$a, $$v); </span><br><span class="line">        <span class="keyword">if</span> ($$el.checked) &#123; $$i &lt; <span class="number">0</span> &amp;&amp; (bar = $$a.concat([$$v])) &#125; </span><br><span class="line">        <span class="keyword">else</span> &#123; </span><br><span class="line">          $$i &gt; <span class="number">-1</span> &amp;&amp; (bar = $$a.slice(<span class="number">0</span>, $$i).concat($$a.slice($$i + <span class="number">1</span>))) &#125; </span><br><span class="line">      &#125; <span class="keyword">else</span> &#123; </span><br><span class="line">        bar = $$c </span><br><span class="line">      &#125; </span><br><span class="line">    &#125; </span><br><span class="line">  &#125; </span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// &lt;select v-model="baz"&gt;</span></span><br><span class="line"><span class="comment">//     &lt;option value="vue"&gt;vue&lt;/option&gt;</span></span><br><span class="line"><span class="comment">//     &lt;option value="react"&gt;react&lt;/option&gt;</span></span><br><span class="line"><span class="comment">// &lt;/select&gt;</span></span><br><span class="line">_c(<span class="string">'select'</span>, &#123; </span><br><span class="line">  directives: [&#123; <span class="attr">name</span>: <span class="string">"model"</span>, <span class="attr">rawName</span>: <span class="string">"v-model"</span>, <span class="attr">value</span>: (baz), <span class="attr">expression</span>: <span class="string">"baz"</span> &#125;], </span><br><span class="line">  on: &#123; </span><br><span class="line">    <span class="string">"change"</span>: <span class="function"><span class="keyword">function</span> (<span class="params">$event</span>) </span>&#123; </span><br><span class="line">      <span class="keyword">var</span> $$selectedVal = <span class="built_in">Array</span>.prototype.filter.call(</span><br><span class="line">        $event.target.options, </span><br><span class="line">        <span class="function"><span class="keyword">function</span> (<span class="params">o</span>) </span>&#123; <span class="keyword">return</span> o.selected &#125;</span><br><span class="line">      ).map(</span><br><span class="line">        <span class="function"><span class="keyword">function</span> (<span class="params">o</span>) </span>&#123; </span><br><span class="line">          <span class="keyword">var</span> val = <span class="string">"_value"</span> <span class="keyword">in</span> o ? o._value : o.value; </span><br><span class="line">          <span class="keyword">return</span> val </span><br><span class="line">        &#125;</span><br><span class="line">      ); </span><br><span class="line">      baz = $event.target.multiple ? $$selectedVal : $$selectedVal[<span class="number">0</span>] </span><br><span class="line">    &#125; </span><br><span class="line">  &#125; </span><br><span class="line">&#125;, [</span><br><span class="line">  _c(<span class="string">'option'</span>, &#123; <span class="attr">attrs</span>: &#123; <span class="string">"value"</span>: <span class="string">"vue"</span> &#125; &#125;, [_v(<span class="string">"vue"</span>)]), _v(<span class="string">" "</span>), </span><br><span class="line">  _c(<span class="string">'option'</span>, &#123; <span class="attr">attrs</span>: &#123; <span class="string">"value"</span>: <span class="string">"react"</span> &#125; &#125;, [_v(<span class="string">"react"</span>)])</span><br><span class="line">])</span><br></pre></td></tr></table></figure>
<a id="more"></a>
<h2 id="Vue-router有几种模式？如何实现呢？"><a href="#Vue-router有几种模式？如何实现呢？" class="headerlink" title="Vue-router有几种模式？如何实现呢？"></a>Vue-router有几种模式？如何实现呢？</h2><blockquote>
<p> 在vue-router中有两种模式 </p>
</blockquote>
<ul>
<li>history<br>history 为 HTML5 Api,提供了丰富的router 相关属性， 比如history.back() 就能轻松的做到页面回退</li>
<li>hash<br>hash router 有一个明显的标志是url 中带有#， 我们可以通过监听url中的hash来进行路由跳转</li>
</ul>
<p><strong>如何实现</strong></p>
<p> <strong>history</strong> </p>
<p> 在代码实现前，我们先看看history几个api </p>
<ul>
<li>history.pushState 浏览器历史纪录添加记录</li>
<li>history.replaceState 修改浏览器历史纪录中当前纪录</li>
<li><p>history.popState 当history 发生变化时触发</p>
<p>在结合代码理解: </p>
</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Routers</span> </span>&#123;</span><br><span class="line">  contructor() &#123;</span><br><span class="line">    <span class="keyword">this</span>.routes = &#123;&#125;;</span><br><span class="line">    <span class="keyword">this</span>.listerPopState()</span><br><span class="line">  &#125;</span><br><span class="line">  init(path) &#123;</span><br><span class="line">    history.replaceState(&#123;</span><br><span class="line">      path: path</span><br><span class="line">    &#125;, <span class="literal">null</span>, path);</span><br><span class="line">    <span class="keyword">this</span>.routes[path] &amp;&amp; <span class="keyword">this</span>.routes[path]()</span><br><span class="line">  &#125;</span><br><span class="line">  route(path, callback) &#123;</span><br><span class="line">    <span class="keyword">this</span>.routes[path] = callback</span><br><span class="line">  &#125;</span><br><span class="line">  push(path) &#123;</span><br><span class="line">    history.pushState(&#123;</span><br><span class="line">      path: path</span><br><span class="line">    &#125;, <span class="literal">null</span>, path);</span><br><span class="line">    <span class="keyword">this</span>.routes[path] &amp;&amp; <span class="keyword">this</span>.routes[path]()</span><br><span class="line">  &#125;</span><br><span class="line">  listerPopState() &#123;</span><br><span class="line">    <span class="built_in">window</span>.addEventListener(<span class="string">'popstate'</span>, e = &gt; &#123;</span><br><span class="line">      <span class="keyword">const</span> path = e.state &amp;&amp; e.state.path;</span><br><span class="line">      <span class="keyword">this</span>.routers[path] &amp;&amp; <span class="keyword">this</span>.routers[path]()</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">window</span>.VueRouter = <span class="keyword">new</span> Routers();</span><br><span class="line">VueRouter.route(<span class="string">'/'</span>, () = &gt; <span class="built_in">console</span>.log(<span class="string">'JS'</span>)) VueRouter.route(<span class="string">'/detail'</span>, () = &gt; <span class="built_in">console</span>.log(<span class="string">'JS每日一题'</span>)) VueRouter.push(<span class="string">'/detail'</span>)</span><br></pre></td></tr></table></figure>
<p> <strong>hash router</strong> </p>
<p> 上面说过我们可以通过监听url中的hash来进行路由跳转 </p>
<p> 结合代码理解: </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Routers</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>() &#123;</span><br><span class="line">    <span class="keyword">this</span>.routes = &#123;&#125;;</span><br><span class="line">    <span class="keyword">this</span>.currentUrl = <span class="string">''</span>;</span><br><span class="line">    <span class="keyword">this</span>.refresh = <span class="keyword">this</span>.refresh.bind(<span class="keyword">this</span>);</span><br><span class="line">    <span class="built_in">window</span>.addEventListener(<span class="string">'load'</span>, <span class="keyword">this</span>.refresh, <span class="literal">false</span>);</span><br><span class="line">    <span class="built_in">window</span>.addEventListener(<span class="string">'hashchange'</span>, <span class="keyword">this</span>.refresh, <span class="literal">false</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  route(path, callback) &#123;</span><br><span class="line">    <span class="keyword">this</span>.routes[path] = callback</span><br><span class="line">  &#125;</span><br><span class="line">  push() &#123;</span><br><span class="line">    <span class="keyword">this</span>.currentUrl = location.hash.slice(<span class="number">1</span>) || <span class="string">'/'</span>;</span><br><span class="line">    <span class="keyword">this</span>.routes[<span class="keyword">this</span>.currentUrl] &amp;&amp; <span class="keyword">this</span>.routes[<span class="keyword">this</span>.currentUrl]()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">window</span>.VueRouter = <span class="keyword">new</span> Routers();</span><br><span class="line">VueRouter.route(<span class="string">'/'</span>, () = &gt; <span class="built_in">console</span>.log(<span class="string">'JS'</span>)) VueRouter.route(<span class="string">'/detail'</span>, () = &gt; <span class="built_in">console</span>.log(<span class="string">'JS每日一题'</span>)) VueRouter.push(<span class="string">'/detail'</span>)</span><br></pre></td></tr></table></figure>
<p> 工作中不必太过纠结使用哪种模式，hash模式url中会带有#号，破坏url整体的美观性, history 需要服务端支持rewrite, 否则刷新会出现404现象 </p>
<h2 id="vue中keepalive怎么理解？"><a href="#vue中keepalive怎么理解？" class="headerlink" title="vue中keepalive怎么理解？"></a>vue中keepalive怎么理解？</h2><blockquote>
<p> 说在前面: keep-alive是vue源码中实现的一个组件, 感兴趣的可以研究源码 <a href="https://github.com/vuejs/vue/blob/dev/src/core/components/keep-alive.js" target="_blank" rel="noopener">https://github.com/vuejs/vue/blob/dev/src/core/components/keep-alive.js</a> </p>
</blockquote>
<p><strong>什么是keepalive</strong></p>
<p>我们平时开发中, 总有部分组件没有必要多次init, 我们需要将组件进行持久化，使组件状态维持不变，在下一次展示时， 也不会进行重新init</p>
<p>keepalive音译过来就是保持活着, 所以在vue中我们可以使用keepalive来进行组件缓存</p>
<p>基本使用</p>
<figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 被keepalive包含的组件会被进行缓存</span></span><br><span class="line"><span class="params">&lt; keep - alive &gt;</span> <span class="params">&lt; component / &gt;</span> <span class="params">&lt; /keep-alive&gt;</span></span><br></pre></td></tr></table></figure>
<p> 上面提到被keepalive包含的组件不会被再次init，也就意味着不会重走生命周期函数, 但是平常工作中很多业务场景是希望我们缓存的组件在再次渲染的能做一些事情,vue为keepalive提供了两个额外的hook </p>
<ul>
<li>activated 当keepalive包含的组件再次渲染的时候触发</li>
<li><p>deactivated 当keepalive包含的组件销毁的时候触发</p>
<p>注: 2.1.0 版本后keepalive包含但被exclude排除的组件不会有以上两个hook </p>
</li>
</ul>
<p><strong>参数</strong></p>
<p> keepalive可以接收3个属性做为参数进行匹配对应的组件进行缓存 </p>
<ul>
<li>include 包含的组件</li>
<li>exclude 排除的组件</li>
<li>max 缓存组件的最大值</li>
</ul>
<p>其中include,exclude可以为字符，数组，以及正则表达式<br>max 类型为字符或者数字</p>
<p>代码理解</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 只缓存组件name为a或者b的组件</span></span><br><span class="line">&lt;keep-alive include = <span class="string">"a,b"</span> &gt; </span><br><span class="line">   &lt;component: is = <span class="string">"currentView"</span> /&gt; </span><br><span class="line">&lt;<span class="regexp">/keep-alive&gt;</span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/ 组件名为c的组件不缓存</span></span><br><span class="line"><span class="regexp">&lt;keep-alive exclude="c"&gt;</span></span><br><span class="line"><span class="regexp">  &lt;component:is="currentView"/</span> &gt; </span><br><span class="line">&lt;<span class="regexp">/keep-alive&gt;</span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/ 如果同时使用include,exclude,那么exclude优先于include， 下面的例子也就是只缓存a组件</span></span><br><span class="line"><span class="regexp">&lt;keep-alive include="a,b"exclude="b"&gt;</span></span><br><span class="line"><span class="regexp">  &lt;component:is="currentView"/</span> &gt;</span><br><span class="line">&lt;<span class="regexp">/keep-alive&gt;</span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/ 如果缓存的组件超过了max设定的值5，那么将删除第一个缓存的组件</span></span><br><span class="line"><span class="regexp">&lt;keep-alive exclude="c"max="5"&gt;</span></span><br><span class="line"><span class="regexp">  &lt;component:is="currentView"/</span> &gt; </span><br><span class="line">&lt;<span class="regexp">/keep-alive&gt;</span></span><br></pre></td></tr></table></figure>
<p><strong>配合router使用</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- template --&gt;</span><br><span class="line"><span class="comment">// 意思就是$router.meta.keepAlive值为真是将组件进行缓存</span></span><br><span class="line">&lt;keep-alive&gt;</span><br><span class="line">  &lt;router-view v-<span class="keyword">if</span>=<span class="string">"$router.meta.keepAlive"</span>&gt;</span><br><span class="line">&lt;<span class="regexp">/router-view&gt;</span></span><br><span class="line"><span class="regexp">&lt;router-view v-if="!$router.meta.keepAlive"&gt;&lt;/</span>router-view&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">//router配置</span></span><br><span class="line"><span class="keyword">new</span> Router(&#123;</span><br><span class="line">  routes: [&#123;</span><br><span class="line">    name: <span class="string">'a'</span>,</span><br><span class="line">    path: <span class="string">'/a'</span>,</span><br><span class="line">    component: A,</span><br><span class="line">    meta: &#123;</span><br><span class="line">      keepAlive: <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;, &#123;</span><br><span class="line">    name: <span class="string">'b'</span>,</span><br><span class="line">    path: <span class="string">'/b'</span>,</span><br><span class="line">    component: B</span><br><span class="line">  &#125;]</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p><strong>总结</strong></p>
<p> keepalive是一个抽象组件，缓存vnode，缓存的组件不会被mounted，为此提供activated 和 deactivated 钩子函数, 使用props max 可以控制缓存组件个数 </p>
<h2 id="Vue-use中都发生了什么？"><a href="#Vue-use中都发生了什么？" class="headerlink" title="Vue.use中都发生了什么？"></a>Vue.use中都发生了什么？</h2><blockquote>
<p>源码地址: <a href="https://github.com/vuejs/vue/blob/dev/src/core/global-api/use.js" target="_blank" rel="noopener">https://github.com/vuejs/vue/blob/dev/src/core/global-api/use.js</a> </p>
</blockquote>
<p><strong>定义</strong></p>
<p>vue.use()往全局注入一个插件，供全局真接使用, 不需要单独引用</p>
<p>代码理解:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Router <span class="keyword">from</span> <span class="string">'vue-router'</span></span><br><span class="line"><span class="comment">// 入口文件全局注入vue-router, 从而可以在全局使用this.$route</span></span><br><span class="line">Vue.use(Router)</span><br><span class="line">如果不使用vue.use那么需在组件中使用都得单独引入</span><br><span class="line"><span class="comment">// a.vue</span></span><br><span class="line"><span class="keyword">import</span> Router <span class="keyword">from</span> <span class="string">'vue-router'</span></span><br><span class="line"><span class="comment">// b.vue</span></span><br><span class="line"><span class="keyword">import</span> Router <span class="keyword">from</span> <span class="string">'vue-router'</span></span><br></pre></td></tr></table></figure>
<p>理解了其基本使用及作用，我们来看一下vue.use中都发生了什么</p>
<p>源码很少，所以直接摘抄了</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">Vue.use = <span class="function"><span class="keyword">function</span>(<span class="params">plugin: Function | Object</span>) </span>&#123; <span class="comment">// flow语法, 检测参数是否是函数或对象</span></span><br><span class="line">    <span class="comment">// 拿到已安装插件列表</span></span><br><span class="line">  <span class="keyword">const</span> installedPlugins = (<span class="keyword">this</span>._installedPlugins || (<span class="keyword">this</span>._installedPlugins = [])) </span><br><span class="line">    <span class="comment">// 如果已经安装，直接跳出方法</span></span><br><span class="line">    <span class="keyword">if</span> (installedPlugins.indexOf(plugin) &gt; <span class="number">-1</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span></span><br><span class="line">  &#125;</span><br><span class="line">    <span class="comment">// additional parameters</span></span><br><span class="line">     </span><br><span class="line">  <span class="comment">// 取vue.use() 传入的参数</span></span><br><span class="line">  <span class="keyword">const</span> args = toArray(<span class="built_in">arguments</span>, <span class="number">1</span>) </span><br><span class="line">    </span><br><span class="line">  <span class="comment">// 将vue对象填充到第一位, 最后的结构为[vue,arg1,arg2,...]</span></span><br><span class="line">    args.unshift(<span class="keyword">this</span>) </span><br><span class="line">    <span class="comment">// 判断插件是否有install方法，如果有执行install方法，如果没有直接把插件当install执行</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> plugin.install === <span class="string">'function'</span>) &#123;</span><br><span class="line">    plugin.install.apply(plugin, args)</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">typeof</span> plugin === <span class="string">'function'</span>) &#123;</span><br><span class="line">    plugin.apply(<span class="literal">null</span>, args)</span><br><span class="line">  &#125;</span><br><span class="line">    <span class="comment">// 注册完成填充至已安装列表，保证每个插件只安装一次</span></span><br><span class="line">  installedPlugins.push(plugin) </span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p> 结合代码理解 </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 代码摘抄自elementui入口文件</span></span><br><span class="line">实现上就是在install中执行了全局注册的操作</span><br><span class="line"><span class="comment">// index.js</span></span><br><span class="line"><span class="keyword">const</span> install = <span class="function"><span class="keyword">function</span>(<span class="params">Vue, opts = &#123;&#125;</span>) </span>&#123;</span><br><span class="line">  locale.use(opts.locale);</span><br><span class="line">  locale.i18n(opts.i18n);</span><br><span class="line">  components.forEach(component = &gt; &#123;</span><br><span class="line">    Vue.component(component.name, component)</span><br><span class="line">  &#125;);...</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span></span><br><span class="line"><span class="keyword">default</span> &#123;</span><br><span class="line">  version: <span class="string">'2.5.4'</span>,</span><br><span class="line">  locale: locale.use,</span><br><span class="line">  i18n: locale.i18n,</span><br><span class="line">  install,</span><br><span class="line">  CollapseTransition,</span><br><span class="line">  Loading,</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//  main.js</span></span><br><span class="line"><span class="keyword">import</span> demo <span class="keyword">from</span> <span class="string">'./idnex'</span></span><br><span class="line">vue.use(demo)</span><br></pre></td></tr></table></figure>
<p><strong>总结</strong></p>
<p> vue.use()为注册全局插件所用，接收函数或者一个包含install属性的对象为参数，如果参数带有install就执行install, 如果没有就直接将参数当install执行, 第一个参数始终为vue对象, 注册过的插件不会重新注册 </p>
<h2 id="简述一下Vue-js的template编译过程？"><a href="#简述一下Vue-js的template编译过程？" class="headerlink" title="简述一下Vue.js的template编译过程？"></a>简述一下Vue.js的template编译过程？</h2><p> 看一下整个流程 </p>
<p><a href="https://imgchr.com/i/r32sIK" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/yangyfeng/yangyfeng.github.io@gh-pages/assets_blog/img/loading.gif" data-original="https://s3.ax1x.com/2020/12/17/r32sIK.jpg" alt="r32sIK.jpg"></a></p>
<p> 从上图中我们可以看到compile是从mount后开始进行中, 整体逻辑分为三个部分 </p>
<ul>
<li>解析器(parse) - 将 <code>模板字符串</code> 转换成 <code>elementASTs</code></li>
<li>优化器(optimize) - 对 <code>AST</code> 进行静态节点标记，主要用来做虚拟DOM的渲染优化</li>
<li>代码生成器(generate) - 使用 <code>elementASTs</code> 生成 <code>render</code> 函数代码字符串</li>
</ul>
<p><strong>开始前先解释一下AST</strong></p>
<p>AST(abstract syntax tree 抽象语法树), 是源代码的抽象语法结构的树状表现形式</p>
<p>从代码上简单理解一下</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt; div <span class="class"><span class="keyword">class</span> </span>= <span class="string">"name"</span> &gt; JS每日一题 &lt; <span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/转成AST后会得到如下格式</span></span><br><span class="line"><span class="regexp">[&#123;</span></span><br><span class="line"><span class="regexp">	"type": "tag",</span></span><br><span class="line"><span class="regexp">	"name": "div",</span></span><br><span class="line"><span class="regexp">	"attribs": &#123;</span></span><br><span class="line"><span class="regexp">		"class": "name"</span></span><br><span class="line"><span class="regexp">	&#125;,</span></span><br><span class="line"><span class="regexp">	"children": [&#123;</span></span><br><span class="line"><span class="regexp">		"data": "JS每日一题",</span></span><br><span class="line"><span class="regexp">		"type": "text",</span></span><br><span class="line"><span class="regexp">		"next": null,</span></span><br><span class="line"><span class="regexp">		"startIndex": 18,</span></span><br><span class="line"><span class="regexp">		"prev": null,</span></span><br><span class="line"><span class="regexp">		"parent": "[Circular ~.0]",</span></span><br><span class="line"><span class="regexp">		"endIndex": 24</span></span><br><span class="line"><span class="regexp">	&#125;],</span></span><br><span class="line"><span class="regexp">	"next": null,</span></span><br><span class="line"><span class="regexp">	"startIndex": 0,</span></span><br><span class="line"><span class="regexp">	"prev": null,</span></span><br><span class="line"><span class="regexp">	"parent": null,</span></span><br><span class="line"><span class="regexp">	"endIndex": 30</span></span><br><span class="line"><span class="regexp">&#125;]</span></span><br></pre></td></tr></table></figure>
<p> AST会经过generate得到render函数，render的返回值是VNode</p>
<blockquote>
<p>VNode的源码可以见    <a href="https://github.com/vuejs/vue/blob/8a2dbf50105ea729125a42fecfe2c2f0371d7836/src/core/vdom/vnode.js" target="_blank" rel="noopener">https://github.com/vuejs/vue/blob/8a2dbf50105ea729125a42fecfe2c2f0371d7836/src/core/vdom/vnode.js</a> </p>
</blockquote>
<p><strong>解析器(parse)</strong></p>
<blockquote>
<p>源码地址 <a href="https://github.com/vuejs/vue/blob/8a2dbf50105ea729125a42fecfe2c2f0371d7836/src/compiler/parser/index.js" target="_blank" rel="noopener">https://github.com/vuejs/vue/blob/8a2dbf50105ea729125a42fecfe2c2f0371d7836/src/compiler/parser/index.js</a> </p>
</blockquote>
<p> parse 的目标是把 template 模板字符串转换成 AST 树，它是一种用 JavaScript 对象的形式来描述整个模板。那么整个 parse 的过程是利用正则表达式顺序解析模板，当解析到开始标签、闭合标签、文本的时候都会分别执行对应的回调函数，来达到构造 AST 树的目的 </p>
<p><strong>优化器(optimize)</strong></p>
<blockquote>
<p> 源码地址 <a href="https://github.com/vuejs/vue/blob/8a2dbf50105ea729125a42fecfe2c2f0371d7836/src/compiler/optimizer.js" target="_blank" rel="noopener">https://github.com/vuejs/vue/blob/8a2dbf50105ea729125a42fecfe2c2f0371d7836/src/compiler/optimizer.js</a> </p>
</blockquote>
<p> 通过 optimize 把整个 AST 树中的每一个 AST 元素节点标记了 static 和 staticRoot, optimize 的过程，就是深度遍历这个 AST 树，去检测它的每一颗子树是不是静态节点，如果是静态节点则它们生成 DOM 永远不需要改变 </p>
<p><strong>代码生成器(generate)</strong></p>
<blockquote>
<p>源码地址  <a href="https://github.com/vuejs/vue/blob/8a2dbf50105ea729125a42fecfe2c2f0371d7836/src/compiler/codegen/index.js" target="_blank" rel="noopener">https://github.com/vuejs/vue/blob/8a2dbf50105ea729125a42fecfe2c2f0371d7836/src/compiler/codegen/index.js</a> </p>
</blockquote>
<p> 把优化后的 AST 树转换成可执行的代码 </p>
<p><strong>总结</strong></p>
<p> 首先通过parse将template解析成AST,其次optimize对解析出来的AST进行标记，最后generate将优化后的AST转换成可执行的代码 </p>
<h2 id="Vue中的nextTick如何理解，它是干什么的？"><a href="#Vue中的nextTick如何理解，它是干什么的？" class="headerlink" title="Vue中的nextTick如何理解，它是干什么的？"></a>Vue中的nextTick如何理解，它是干什么的？</h2><blockquote>
<p>在vue中，数据发生变化之后DOM并不会立即变化，而是等同一事件循环中的所有数据变化完成之后，再统一进行视图更新 </p>
</blockquote>
<p> 代码理解 </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>.name = <span class="string">'JS每日一题'</span> <span class="comment">// 如这个绑定在某一个DOM元素上</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">this</span>.$el.textContent) </span><br><span class="line"><span class="comment">// 这时DOM还没有更新,所以不会得到文字JS每日一题</span></span><br><span class="line"><span class="keyword">this</span>.$nextTick(() = &gt;<span class="built_in">console</span>.log(<span class="keyword">this</span>.$el.textContent)) </span><br><span class="line"><span class="comment">// nextTick 是在DOM更新后执行，这里打印JS每日一题</span></span><br></pre></td></tr></table></figure>
<p><strong>nextTick什么情况下会触发</strong></p>
<p> 在同一事件循环中的数据变化后，DOM更新完成, 执行nextTick(callback)内的回调 </p>
<p> 对事件循环不理解的可以点<a href="https://mp.weixin.qq.com/s?__biz=MzU1OTgxNDQ1Nw==&amp;mid=2247483672&amp;idx=1&amp;sn=d7cf78506c258e6992f9637a107d35b9&amp;scene=21#wechat_redirect" target="_blank" rel="noopener">这里</a> </p>
<p><strong>vue中nextTick的实现</strong></p>
<blockquote>
<p>源码地址 <a href="https://github.com/vuejs/vue/blob/dev/src/core/util/next-tick.js" target="_blank" rel="noopener">https://github.com/vuejs/vue/blob/dev/src/core/util/next-tick.js</a> </p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">flushCallbacks</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  pending = <span class="literal">false</span> </span><br><span class="line">  </span><br><span class="line">  <span class="comment">// 复制一份callbacks  </span></span><br><span class="line">  <span class="keyword">const</span> copies = callbacks.slice(<span class="number">0</span>) </span><br><span class="line">  <span class="comment">// 清空callbacks</span></span><br><span class="line">  callbacks.length = <span class="number">0</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; copies.length; i++) &#123;</span><br><span class="line">    <span class="comment">// 顺序执行nexttick传入的回调</span></span><br><span class="line">    copies[i]()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">nextTick</span>(<span class="params">cb ? :Function, ctx ? :Object</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> _resolve </span><br><span class="line">  <span class="comment">// 将回调压入callbacks</span></span><br><span class="line">  callbacks.push(() = &gt;&#123;</span><br><span class="line">    <span class="keyword">if</span> (cb) &#123;</span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        cb.call(ctx)</span><br><span class="line">      &#125; <span class="keyword">catch</span>(e) &#123;</span><br><span class="line">        handleError(e, ctx, <span class="string">'nextTick'</span>)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (_resolve) &#123;</span><br><span class="line">      _resolve(ctx)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;) <span class="keyword">if</span> (!pending) &#123;</span><br><span class="line">    pending = <span class="literal">true</span> </span><br><span class="line">    <span class="comment">// timerFunc的源码较多，大致意思就是根据 useMacroTask 条件执行 macroTimerFunc 或者是 microTimerFunc，而它们都会在下一个 tick 执行 flushCallbacks，flushCallbacks 的逻辑非常简单，对 callbacks 遍历，然后执行相应的回调函数 (见上面的flushCallbacks方法)</span></span><br><span class="line">    timerFunc()</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 如果nextTick不传cb,就为nextTick提供一个promise调用 如: nextTick().then(()=&gt; &#123;&#125;)</span></span><br><span class="line">  <span class="keyword">if</span> (!cb &amp;&amp; <span class="keyword">typeof</span> <span class="built_in">Promise</span> !== <span class="string">'undefined'</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(resolve = &gt;&#123;</span><br><span class="line">      _resolve = resolve</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>总结</strong></p>
<p> 数据的变化到 DOM 的重新渲染是一个异步过程, 我们必须在 nextTick 后执行DOM相关的操作 </p>
<p> 这道题考查大家对vue异步更新队列的理解，有一定深度，如果能够很好回答此题，对面试效果有极大帮助 </p>
<p>答题思路：</p>
<ol>
<li>nextTick是啥？下一个定义</li>
<li>为什么需要它呢？用异步更新队列实现原理解释</li>
<li>我再什么地方用它呢？抓抓头，想想你在平时开发中使用它的地方</li>
<li>下面介绍一下如何使用nextTick</li>
<li><p>最后能说出源码实现就会显得你格外优秀</p>
<p>先看看官方定义 </p>
</li>
</ol>
<blockquote>
<p>Vue.nextTick( [callback, context] )</p>
<p>在下次 DOM 更新循环结束之后执行延迟回调。在修改数据之后立即使用这个方法，获取更新后的 DOM。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&gt;<span class="comment">// 修改数据</span></span><br><span class="line">&gt;vm.msg = <span class="string">'Hello'</span></span><br><span class="line">&gt;<span class="comment">// DOM 还没有更新</span></span><br><span class="line">&gt;Vue.nextTick(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">&gt;<span class="comment">// DOM 更新了</span></span><br><span class="line">&gt;&#125;)</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<blockquote>
</blockquote>
<p> 回答范例： </p>
<ol>
<li>nextTick是Vue提供的一个全局API，由于vue的异步更新策略导致我们对数据的修改不会立刻体现在dom变化上，此时如果想要立即获取更新后的dom状态，就需要使用这个方法</li>
<li>Vue 在更新 DOM 时是<strong>异步</strong>执行的。只要侦听到数据变化，Vue 将开启一个队列，并缓冲在同一事件循环中发生的所有数据变更。如果同一个 watcher 被多次触发，只会被推入到队列中一次。这种在缓冲时去除重复数据对于避免不必要的计算和 DOM 操作是非常重要的。nextTick方法会在队列中加入一个回调函数，确保该函数在前面的dom操作完成后才调用。</li>
<li>所以当我们想在修改数据后立即看到dom执行结果就需要用到nextTick方法。</li>
<li>比如，我在干什么的时候就会使用nextTick，传一个回调函数进去，在里面执行dom操作即可。</li>
<li>我也有简单了解nextTick实现，它会在callbacks里面加入我们传入的函数，然后用timerFunc异步方式调用它们，首选的异步方式会是Promise。这让我明白了为什么可以在nextTick中看到dom操作结果。</li>
</ol>
<h2 id="nextTick实现原理"><a href="#nextTick实现原理" class="headerlink" title="nextTick实现原理?"></a>nextTick实现原理?</h2><p> 此题属于原理题目，能够体现面试者对vue理解深度，答好了会加分很多。 </p>
<p>答题思路：</p>
<ol>
<li>此题实际考查vue异步更新策略</li>
<li>说出vue是怎么通过异步、批量的方式更新以提高性能的</li>
<li>最后把源码中实现说一下</li>
</ol>
<p>回答范例：</p>
<ol>
<li><p>vue有个批量、异步更新策略，数据变化时，vue开启一个队列，并缓冲在同一事件循环中发生的所有数据变更。如果同一个 watcher 被多次触发，只会被推入到队列中一次。然后在下一个的事件循环“tick”中，Vue 刷新队列并执行实际 (已去重的) 工作。Vue 在内部对异步队列尝试使用原生的 Promise.then、MutationObserver 和 setImmediate，如果执行环境不支持，则会采用 setTimeout(fn, 0) 代替。</p>
<blockquote>
<p><a href="https://cn.vuejs.org/v2/guide/reactivity.html#异步更新队列" target="_blank" rel="noopener">官方文档在这里</a></p>
</blockquote>
</li>
<li><p>源码中，修改一个数据，组件对应的watcher会尝试入队:</p>
</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">queue.push(watcher)</span><br></pre></td></tr></table></figure>
<p> 并使用nextTick方法添加一个flushSchedulerQueue回调 </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nextTick(flushSchedulerQueue)</span><br></pre></td></tr></table></figure>
<p> flushSchedulerQueue被加入callbacks数组 </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">callbacks.push(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (cb) &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      cb.call(ctx) <span class="comment">// cb就是加入的回调</span></span><br><span class="line">    &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">      handleError(e, ctx, <span class="string">'nextTick'</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; </span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p> 然后以异步方式启动 </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (!pending) &#123;</span><br><span class="line">  pending = <span class="literal">true</span></span><br><span class="line">  timerFunc()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p> timerFunc的异步主要利用Promise等微任务方式实现 </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> timerFunc</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="built_in">Promise</span> !== <span class="string">'undefined'</span> &amp;&amp; isNative(<span class="built_in">Promise</span>)) &#123;</span><br><span class="line">  <span class="keyword">const</span> p = <span class="built_in">Promise</span>.resolve()</span><br><span class="line">  <span class="comment">// timerFunc利用p.then向微任务队列添加一个flushCallbacks</span></span><br><span class="line">  <span class="comment">// 会异步调用flushCallbacks</span></span><br><span class="line">  timerFunc = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    p.then(flushCallbacks)</span><br><span class="line">  &#125;</span><br><span class="line">  isUsingMicroTask = <span class="literal">true</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p> flushCallbacks遍历callbacks，执行里面所有回调 </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">flushCallbacks</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  pending = <span class="literal">false</span></span><br><span class="line">  <span class="keyword">const</span> copies = callbacks.slice(<span class="number">0</span>)</span><br><span class="line">  callbacks.length = <span class="number">0</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; copies.length; i++) &#123;</span><br><span class="line">    copies[i]()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p> 其中就有前面加入的flushSchedulerQueue，它主要用于执行queue中所有watcher的run方法，从而使组件们更新 </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (index = <span class="number">0</span>; index &lt; queue.length; index++) &#123;</span><br><span class="line">  watcher = queue[index]</span><br><span class="line">  watcher.run()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>可能的追问</p>
<p> 你平时什么时候会用到nextTick？ </p>

        </div>
        
          


  <section class='meta' id="footer-meta">
    <hr>
    <div class='new-meta-box'>
      
        
          <div class="new-meta-item date" itemprop="dateUpdated" datetime="2020-12-22T17:31:15+08:00">
  <a class='notlink'>
    <i class="fas fa-clock" aria-hidden="true"></i>
    <p>最后更新于 2020年12月22日</p>
  </a>
</div>

        
      
        
          
  
  <div class="new-meta-item meta-tags"><a class="tag" href="/blogpost/tags/vue/" rel="nofollow"><i class="fas fa-hashtag" aria-hidden="true"></i>&nbsp;<p>vue</p></a></div> <div class="new-meta-item meta-tags"><a class="tag" href="/blogpost/tags/面试题/" rel="nofollow"><i class="fas fa-hashtag" aria-hidden="true"></i>&nbsp;<p>面试题</p></a></div>


        
      
        
          
  <div class="new-meta-item share -mob-share-list">
  <div class="-mob-share-list share-body">
    
      
        <a class="-mob-share-qq" title="QQ好友" rel="external nofollow noopener noreferrer"
          
          href="http://connect.qq.com/widget/shareqq/index.html?url=https://yangyfeng.github.io/posts/f0a558a1.html&title=vue面试题（1） | 峰享会&pics=https://s2.ax1x.com/2019/07/12/Zhm4jf.jpg&summary=Vue双向绑定实现原理？vue实现数据双向绑定主要是：采用数据劫持结合发布者-订阅者模式的方式，通过 Object.defineProperty() 来劫持各个属性的setter，getter，在数据变动时发布消息给订阅者，触发相应监听回调。当把一个普通 Javascript 对象传给 Vue 实例来作为它的 data 选项时，Vue 将遍历它的属性，用 Object.defineProperty() 将它们转为 getter/setter。用户看不到 getter/setter，但是在内部它们让 Vue 追踪依赖，在属性被访问和修改时通知变化。
vue的数据双向绑定 将MVVM作为数据绑定的入口，整合Observer，Compile和Watcher三者，通过Observer来监听自己的model的数据变化，通过Compile来解析编译模板指令（vue中是用来解析 双花括弧），最终利用watcher搭起observer和Compile之间的通信桥梁，达到数据变化 —&gt;视图更新；视图交互变化（input）—&gt;数据model变更双向绑定效果。

Observer 对所有数据的属性进行监听
Compile 对每个元素节点的指令进行扫描跟解析,根据指令模板替换数据,以及绑定相应的更新函数
Watcher 作为连接Observer 跟 Compile 之间的桥梁, 能够订阅接收到每个属性变动的通知,执行相应的回调函数

代码理解: 
12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091929394959697const Dep = function() &#123;  this.subs = []&#125;;Dep.prototype = &#123;  addSub: function(sub) &#123;    this.subs.push(sub)  &#125;,  notify: function() &#123;    this.subs.forEach(sub = &gt; &#123;      sub.update()    &#125;)  &#125;,&#125;;const Watcher = function(vm, node, name) &#123;  Dep.target = this;  this.name = name;  this.node = node;  this.vm = vm;  this.update();  Dep.target = null&#125;;Watcher.prototype = &#123;  update: function() &#123;    this.get();    this.node.nodeValue = this.value  &#125;,  get: function() &#123;    this.value = this.vm[this.name]  &#125;,&#125;;const compile = function(node, vm) &#123;  if (node.nodeType === 1) &#123;    let attr = node.attributes;    for (let i = 0; i &lt; attr.length; i++) &#123;      if (attr[i].nodeName === 'v-model') &#123;        let name = attr[i].nodeValue;        node.addEventListener('input', e = &gt; &#123;          vm[name] = node.value        &#125;);        node.value = vm[name];        node.removeAttribute('v-model')      &#125;    &#125;  &#125;  if (node.nodeType === 3) &#123;    if (/\&#123;\&#123;(.*)\&#125;\&#125;/.test(node.nodeValue)) &#123;      let name = RegExp.$1;      name = name.trim();      node.nodeValue = vm[name];      new Watcher(vm, node, name)    &#125;  &#125;&#125;;const observe = data = &gt; &#123;  if (!data || typeof data !== 'object') return 3344;  Object.keys(data).forEach(key = &gt; defineReactive(data, key, data[key]))&#125;;const defineReactive = (data, key, value) = &gt; &#123;  const dep = new Dep();  observe(value);  Object.defineProperty(data, key, &#123;    get: () = &gt; &#123;      if (Dep.target) dep.addSub(Dep.target);      return value    &#125;,    set: function(newValue) &#123;      console.log(`数据已发生变化，新的值为$ &#123;				newValue			&#125;`);      value = newValue;      dep.notify()    &#125;,  &#125;)&#125;;function nodeToFragment(node, vm) &#123;  let flag = document.createDocumentFragment();  let child;  while ((child = node.firstChild)) &#123;    compile(child, vm);    flag.appendChild(child)  &#125;  return flag&#125;function Vue(options) &#123;  let data = this.data = options.data;  observe(data, this);  let id = options.el;  let dom = nodeToFragment(document.getElementById(id), data);  document.getElementById(id).appendChild(dom)&#125;let vm = new Vue(&#123;  el: 'app',  data: &#123;    text: 'example text',  &#125;,&#125;);
 题目分析：双向绑定是vue的特色之一，开发中必然会用到的知识点，然而此题还问了实现原理，升级为深度考查。 
思路分析：3w1h

给出双绑定义
双绑带来的好处
在哪使用双绑
使用方式
扩展：使用细节、原理实现描述

回答范例：

vue中双向绑定是一个指令v-model，可以绑定一个动态值到视图，同时视图中变化能改变该值。v-model是语法糖，默认情况下相当于:value和@input。
使用v-model可以减少大量繁琐的事件处理代码，提高开发效率，代码可读性也更好
通常在表单项上使用v-model
原生的表单项可以直接使用v-model，自定义组件上如果要使用它需要在组件内绑定value并处理输入事件
我做过测试，输出包含v-model模板的组件渲染函数，发现它会被转换为value属性的绑定以及一个事件监听，事件回调函数中会做相应变量更新操作，这说明神奇魔法实际上是vue的编译器完成的。

可能的追问：

v-model和sync修饰符有什么区别
自定义组件使用v-model如果想要改变事件名或者属性名应该怎么做
观察输出的渲染函数： 


123456789101112// &lt;input type="text" v-model="foo"&gt;_c('input', &#123;   directives: [&#123; name: "model", rawName: "v-model", value: (foo), expression: "foo" &#125;],   attrs: &#123; "type": "text" &#125;,   domProps: &#123; "value": (foo) &#125;,   on: &#123;     "input": function ($event) &#123;       if ($event.target.composing) return;       foo = $event.target.value     &#125;   &#125; &#125;)
123456789101112131415161718192021// &lt;input type="checkbox" v-model="bar"&gt;_c('input', &#123;   directives: [&#123; name: "model", rawName: "v-model", value: (bar), expression: "bar" &#125;],   attrs: &#123; "type": "checkbox" &#125;,   domProps: &#123;     "checked": Array.isArray(bar) ? _i(bar, null) &gt; -1 : (bar)   &#125;,   on: &#123;     "change": function ($event) &#123;       var $$a = bar, $$el = $event.target, $$c = $$el.checked ? (true) : (false);       if (Array.isArray($$a)) &#123;         var $$v = null, $$i = _i($$a, $$v);         if ($$el.checked) &#123; $$i &lt; 0 &amp;&amp; (bar = $$a.concat([$$v])) &#125;         else &#123;           $$i &gt; -1 &amp;&amp; (bar = $$a.slice(0, $$i).concat($$a.slice($$i + 1))) &#125;       &#125; else &#123;         bar = $$c       &#125;     &#125;   &#125; &#125;)
123456789101112131415161718192021222324// &lt;select v-model="baz"&gt;//     &lt;option value="vue"&gt;vue&lt;/option&gt;//     &lt;option value="react"&gt;react&lt;/option&gt;// &lt;/select&gt;_c('select', &#123;   directives: [&#123; name: "model", rawName: "v-model", value: (baz), expression: "baz" &#125;],   on: &#123;     "change": function ($event) &#123;       var $$selectedVal = Array.prototype.filter.call(        $event.target.options,         function (o) &#123; return o.selected &#125;      ).map(        function (o) &#123;           var val = "_value" in o ? o._value : o.value;           return val         &#125;      );       baz = $event.target.multiple ? $$selectedVal : $$selectedVal[0]     &#125;   &#125; &#125;, [  _c('option', &#123; attrs: &#123; "value": "vue" &#125; &#125;, [_v("vue")]), _v(" "),   _c('option', &#123; attrs: &#123; "value": "react" &#125; &#125;, [_v("react")])])"
          
          >
          
            <img src="https://cdn.jsdelivr.net/gh/xaoxuu/assets@19.1.9/logo/128/qq.png">
          
        </a>
      
    
      
        <a class="-mob-share-qzone" title="QQ空间" rel="external nofollow noopener noreferrer"
          
          href="https://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=https://yangyfeng.github.io/posts/f0a558a1.html&title=vue面试题（1） | 峰享会&pics=https://s2.ax1x.com/2019/07/12/Zhm4jf.jpg&summary=Vue双向绑定实现原理？vue实现数据双向绑定主要是：采用数据劫持结合发布者-订阅者模式的方式，通过 Object.defineProperty() 来劫持各个属性的setter，getter，在数据变动时发布消息给订阅者，触发相应监听回调。当把一个普通 Javascript 对象传给 Vue 实例来作为它的 data 选项时，Vue 将遍历它的属性，用 Object.defineProperty() 将它们转为 getter/setter。用户看不到 getter/setter，但是在内部它们让 Vue 追踪依赖，在属性被访问和修改时通知变化。
vue的数据双向绑定 将MVVM作为数据绑定的入口，整合Observer，Compile和Watcher三者，通过Observer来监听自己的model的数据变化，通过Compile来解析编译模板指令（vue中是用来解析 双花括弧），最终利用watcher搭起observer和Compile之间的通信桥梁，达到数据变化 —&gt;视图更新；视图交互变化（input）—&gt;数据model变更双向绑定效果。

Observer 对所有数据的属性进行监听
Compile 对每个元素节点的指令进行扫描跟解析,根据指令模板替换数据,以及绑定相应的更新函数
Watcher 作为连接Observer 跟 Compile 之间的桥梁, 能够订阅接收到每个属性变动的通知,执行相应的回调函数

代码理解: 
12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091929394959697const Dep = function() &#123;  this.subs = []&#125;;Dep.prototype = &#123;  addSub: function(sub) &#123;    this.subs.push(sub)  &#125;,  notify: function() &#123;    this.subs.forEach(sub = &gt; &#123;      sub.update()    &#125;)  &#125;,&#125;;const Watcher = function(vm, node, name) &#123;  Dep.target = this;  this.name = name;  this.node = node;  this.vm = vm;  this.update();  Dep.target = null&#125;;Watcher.prototype = &#123;  update: function() &#123;    this.get();    this.node.nodeValue = this.value  &#125;,  get: function() &#123;    this.value = this.vm[this.name]  &#125;,&#125;;const compile = function(node, vm) &#123;  if (node.nodeType === 1) &#123;    let attr = node.attributes;    for (let i = 0; i &lt; attr.length; i++) &#123;      if (attr[i].nodeName === 'v-model') &#123;        let name = attr[i].nodeValue;        node.addEventListener('input', e = &gt; &#123;          vm[name] = node.value        &#125;);        node.value = vm[name];        node.removeAttribute('v-model')      &#125;    &#125;  &#125;  if (node.nodeType === 3) &#123;    if (/\&#123;\&#123;(.*)\&#125;\&#125;/.test(node.nodeValue)) &#123;      let name = RegExp.$1;      name = name.trim();      node.nodeValue = vm[name];      new Watcher(vm, node, name)    &#125;  &#125;&#125;;const observe = data = &gt; &#123;  if (!data || typeof data !== 'object') return 3344;  Object.keys(data).forEach(key = &gt; defineReactive(data, key, data[key]))&#125;;const defineReactive = (data, key, value) = &gt; &#123;  const dep = new Dep();  observe(value);  Object.defineProperty(data, key, &#123;    get: () = &gt; &#123;      if (Dep.target) dep.addSub(Dep.target);      return value    &#125;,    set: function(newValue) &#123;      console.log(`数据已发生变化，新的值为$ &#123;				newValue			&#125;`);      value = newValue;      dep.notify()    &#125;,  &#125;)&#125;;function nodeToFragment(node, vm) &#123;  let flag = document.createDocumentFragment();  let child;  while ((child = node.firstChild)) &#123;    compile(child, vm);    flag.appendChild(child)  &#125;  return flag&#125;function Vue(options) &#123;  let data = this.data = options.data;  observe(data, this);  let id = options.el;  let dom = nodeToFragment(document.getElementById(id), data);  document.getElementById(id).appendChild(dom)&#125;let vm = new Vue(&#123;  el: 'app',  data: &#123;    text: 'example text',  &#125;,&#125;);
 题目分析：双向绑定是vue的特色之一，开发中必然会用到的知识点，然而此题还问了实现原理，升级为深度考查。 
思路分析：3w1h

给出双绑定义
双绑带来的好处
在哪使用双绑
使用方式
扩展：使用细节、原理实现描述

回答范例：

vue中双向绑定是一个指令v-model，可以绑定一个动态值到视图，同时视图中变化能改变该值。v-model是语法糖，默认情况下相当于:value和@input。
使用v-model可以减少大量繁琐的事件处理代码，提高开发效率，代码可读性也更好
通常在表单项上使用v-model
原生的表单项可以直接使用v-model，自定义组件上如果要使用它需要在组件内绑定value并处理输入事件
我做过测试，输出包含v-model模板的组件渲染函数，发现它会被转换为value属性的绑定以及一个事件监听，事件回调函数中会做相应变量更新操作，这说明神奇魔法实际上是vue的编译器完成的。

可能的追问：

v-model和sync修饰符有什么区别
自定义组件使用v-model如果想要改变事件名或者属性名应该怎么做
观察输出的渲染函数： 


123456789101112// &lt;input type="text" v-model="foo"&gt;_c('input', &#123;   directives: [&#123; name: "model", rawName: "v-model", value: (foo), expression: "foo" &#125;],   attrs: &#123; "type": "text" &#125;,   domProps: &#123; "value": (foo) &#125;,   on: &#123;     "input": function ($event) &#123;       if ($event.target.composing) return;       foo = $event.target.value     &#125;   &#125; &#125;)
123456789101112131415161718192021// &lt;input type="checkbox" v-model="bar"&gt;_c('input', &#123;   directives: [&#123; name: "model", rawName: "v-model", value: (bar), expression: "bar" &#125;],   attrs: &#123; "type": "checkbox" &#125;,   domProps: &#123;     "checked": Array.isArray(bar) ? _i(bar, null) &gt; -1 : (bar)   &#125;,   on: &#123;     "change": function ($event) &#123;       var $$a = bar, $$el = $event.target, $$c = $$el.checked ? (true) : (false);       if (Array.isArray($$a)) &#123;         var $$v = null, $$i = _i($$a, $$v);         if ($$el.checked) &#123; $$i &lt; 0 &amp;&amp; (bar = $$a.concat([$$v])) &#125;         else &#123;           $$i &gt; -1 &amp;&amp; (bar = $$a.slice(0, $$i).concat($$a.slice($$i + 1))) &#125;       &#125; else &#123;         bar = $$c       &#125;     &#125;   &#125; &#125;)
123456789101112131415161718192021222324// &lt;select v-model="baz"&gt;//     &lt;option value="vue"&gt;vue&lt;/option&gt;//     &lt;option value="react"&gt;react&lt;/option&gt;// &lt;/select&gt;_c('select', &#123;   directives: [&#123; name: "model", rawName: "v-model", value: (baz), expression: "baz" &#125;],   on: &#123;     "change": function ($event) &#123;       var $$selectedVal = Array.prototype.filter.call(        $event.target.options,         function (o) &#123; return o.selected &#125;      ).map(        function (o) &#123;           var val = "_value" in o ? o._value : o.value;           return val         &#125;      );       baz = $event.target.multiple ? $$selectedVal : $$selectedVal[0]     &#125;   &#125; &#125;, [  _c('option', &#123; attrs: &#123; "value": "vue" &#125; &#125;, [_v("vue")]), _v(" "),   _c('option', &#123; attrs: &#123; "value": "react" &#125; &#125;, [_v("react")])])"
          
          >
          
            <img src="https://cdn.jsdelivr.net/gh/xaoxuu/assets@19.1.9/logo/128/qzone.png">
          
        </a>
      
    
      
        <a class="-mob-share-weibo" title="微博" rel="external nofollow noopener noreferrer"
          
          href="http://service.weibo.com/share/share.php?url=https://yangyfeng.github.io/posts/f0a558a1.html&title=vue面试题（1） | 峰享会&pics=https://s2.ax1x.com/2019/07/12/Zhm4jf.jpg&summary=Vue双向绑定实现原理？vue实现数据双向绑定主要是：采用数据劫持结合发布者-订阅者模式的方式，通过 Object.defineProperty() 来劫持各个属性的setter，getter，在数据变动时发布消息给订阅者，触发相应监听回调。当把一个普通 Javascript 对象传给 Vue 实例来作为它的 data 选项时，Vue 将遍历它的属性，用 Object.defineProperty() 将它们转为 getter/setter。用户看不到 getter/setter，但是在内部它们让 Vue 追踪依赖，在属性被访问和修改时通知变化。
vue的数据双向绑定 将MVVM作为数据绑定的入口，整合Observer，Compile和Watcher三者，通过Observer来监听自己的model的数据变化，通过Compile来解析编译模板指令（vue中是用来解析 双花括弧），最终利用watcher搭起observer和Compile之间的通信桥梁，达到数据变化 —&gt;视图更新；视图交互变化（input）—&gt;数据model变更双向绑定效果。

Observer 对所有数据的属性进行监听
Compile 对每个元素节点的指令进行扫描跟解析,根据指令模板替换数据,以及绑定相应的更新函数
Watcher 作为连接Observer 跟 Compile 之间的桥梁, 能够订阅接收到每个属性变动的通知,执行相应的回调函数

代码理解: 
12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091929394959697const Dep = function() &#123;  this.subs = []&#125;;Dep.prototype = &#123;  addSub: function(sub) &#123;    this.subs.push(sub)  &#125;,  notify: function() &#123;    this.subs.forEach(sub = &gt; &#123;      sub.update()    &#125;)  &#125;,&#125;;const Watcher = function(vm, node, name) &#123;  Dep.target = this;  this.name = name;  this.node = node;  this.vm = vm;  this.update();  Dep.target = null&#125;;Watcher.prototype = &#123;  update: function() &#123;    this.get();    this.node.nodeValue = this.value  &#125;,  get: function() &#123;    this.value = this.vm[this.name]  &#125;,&#125;;const compile = function(node, vm) &#123;  if (node.nodeType === 1) &#123;    let attr = node.attributes;    for (let i = 0; i &lt; attr.length; i++) &#123;      if (attr[i].nodeName === 'v-model') &#123;        let name = attr[i].nodeValue;        node.addEventListener('input', e = &gt; &#123;          vm[name] = node.value        &#125;);        node.value = vm[name];        node.removeAttribute('v-model')      &#125;    &#125;  &#125;  if (node.nodeType === 3) &#123;    if (/\&#123;\&#123;(.*)\&#125;\&#125;/.test(node.nodeValue)) &#123;      let name = RegExp.$1;      name = name.trim();      node.nodeValue = vm[name];      new Watcher(vm, node, name)    &#125;  &#125;&#125;;const observe = data = &gt; &#123;  if (!data || typeof data !== 'object') return 3344;  Object.keys(data).forEach(key = &gt; defineReactive(data, key, data[key]))&#125;;const defineReactive = (data, key, value) = &gt; &#123;  const dep = new Dep();  observe(value);  Object.defineProperty(data, key, &#123;    get: () = &gt; &#123;      if (Dep.target) dep.addSub(Dep.target);      return value    &#125;,    set: function(newValue) &#123;      console.log(`数据已发生变化，新的值为$ &#123;				newValue			&#125;`);      value = newValue;      dep.notify()    &#125;,  &#125;)&#125;;function nodeToFragment(node, vm) &#123;  let flag = document.createDocumentFragment();  let child;  while ((child = node.firstChild)) &#123;    compile(child, vm);    flag.appendChild(child)  &#125;  return flag&#125;function Vue(options) &#123;  let data = this.data = options.data;  observe(data, this);  let id = options.el;  let dom = nodeToFragment(document.getElementById(id), data);  document.getElementById(id).appendChild(dom)&#125;let vm = new Vue(&#123;  el: 'app',  data: &#123;    text: 'example text',  &#125;,&#125;);
 题目分析：双向绑定是vue的特色之一，开发中必然会用到的知识点，然而此题还问了实现原理，升级为深度考查。 
思路分析：3w1h

给出双绑定义
双绑带来的好处
在哪使用双绑
使用方式
扩展：使用细节、原理实现描述

回答范例：

vue中双向绑定是一个指令v-model，可以绑定一个动态值到视图，同时视图中变化能改变该值。v-model是语法糖，默认情况下相当于:value和@input。
使用v-model可以减少大量繁琐的事件处理代码，提高开发效率，代码可读性也更好
通常在表单项上使用v-model
原生的表单项可以直接使用v-model，自定义组件上如果要使用它需要在组件内绑定value并处理输入事件
我做过测试，输出包含v-model模板的组件渲染函数，发现它会被转换为value属性的绑定以及一个事件监听，事件回调函数中会做相应变量更新操作，这说明神奇魔法实际上是vue的编译器完成的。

可能的追问：

v-model和sync修饰符有什么区别
自定义组件使用v-model如果想要改变事件名或者属性名应该怎么做
观察输出的渲染函数： 


123456789101112// &lt;input type="text" v-model="foo"&gt;_c('input', &#123;   directives: [&#123; name: "model", rawName: "v-model", value: (foo), expression: "foo" &#125;],   attrs: &#123; "type": "text" &#125;,   domProps: &#123; "value": (foo) &#125;,   on: &#123;     "input": function ($event) &#123;       if ($event.target.composing) return;       foo = $event.target.value     &#125;   &#125; &#125;)
123456789101112131415161718192021// &lt;input type="checkbox" v-model="bar"&gt;_c('input', &#123;   directives: [&#123; name: "model", rawName: "v-model", value: (bar), expression: "bar" &#125;],   attrs: &#123; "type": "checkbox" &#125;,   domProps: &#123;     "checked": Array.isArray(bar) ? _i(bar, null) &gt; -1 : (bar)   &#125;,   on: &#123;     "change": function ($event) &#123;       var $$a = bar, $$el = $event.target, $$c = $$el.checked ? (true) : (false);       if (Array.isArray($$a)) &#123;         var $$v = null, $$i = _i($$a, $$v);         if ($$el.checked) &#123; $$i &lt; 0 &amp;&amp; (bar = $$a.concat([$$v])) &#125;         else &#123;           $$i &gt; -1 &amp;&amp; (bar = $$a.slice(0, $$i).concat($$a.slice($$i + 1))) &#125;       &#125; else &#123;         bar = $$c       &#125;     &#125;   &#125; &#125;)
123456789101112131415161718192021222324// &lt;select v-model="baz"&gt;//     &lt;option value="vue"&gt;vue&lt;/option&gt;//     &lt;option value="react"&gt;react&lt;/option&gt;// &lt;/select&gt;_c('select', &#123;   directives: [&#123; name: "model", rawName: "v-model", value: (baz), expression: "baz" &#125;],   on: &#123;     "change": function ($event) &#123;       var $$selectedVal = Array.prototype.filter.call(        $event.target.options,         function (o) &#123; return o.selected &#125;      ).map(        function (o) &#123;           var val = "_value" in o ? o._value : o.value;           return val         &#125;      );       baz = $event.target.multiple ? $$selectedVal : $$selectedVal[0]     &#125;   &#125; &#125;, [  _c('option', &#123; attrs: &#123; "value": "vue" &#125; &#125;, [_v("vue")]), _v(" "),   _c('option', &#123; attrs: &#123; "value": "react" &#125; &#125;, [_v("react")])])"
          
          >
          
            <img src="https://cdn.jsdelivr.net/gh/xaoxuu/assets@19.1.9/logo/128/weibo.png">
          
        </a>
      
    
      
        <a class='qrcode' rel="external nofollow noopener noreferrer" href='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMYAAADGCAAAAACs8KCBAAACLUlEQVR42u3aS27DMAwFwNz/0um2RWvnPcopEHm0MgJ/NFowIqnHIx7Pb+P3L0fj+53nbz76ysUDAwPjYxn5VH5/4Pye9j3tYmFgYNyNkYTCPByfTyIJ5fncMDAwMFpGHnBbEgYGBkbOmKWdK5tLDAwMjLZklkz9qu3gW3JxDAyMD2TkVff/v35LfwMDA+OjGM9ynG/OZtOaNUd/PIWBgbE1Iw9w7XGKlV+GKTEGBsYNGCsHHa6a9Mr7MTAw9mbkBbWVgtf5U3n788XbMDAwtmO0U89T1ny67VJeEGQxMDA+irF+qOJ9z9ZBHwMDY2vGVUlmvr1rWwhFgxMDA2M7xtsz4zj1bWfy4xoDA2NrRh4088Ry1lpom5ovtoYYGBg3YLSF/rZ81i5H0ZbAwMDYjtEepGjvmbUt840jBgbGfRgriehKA2DlnsNcHAMDY1PGenNxFqbb5uVhsMbAwNiaMZtcUkRrm5p5Un34LAYGxtaMpG3ZBs3ZUYwkfL9IazEwMDZlzFLZHD9bsmQp//jfwMDA2JrRPrxe7p81Gx75izAwMLZjzAphs5MdLbXY22JgYGzHeJZjFnDbg2X5kmFgYNyBkY+k9NYe12iLd0XtEAMDYztGHmRn8W2WvuaBGwMD4z6M9cbkbCs5S2IPj4VhYGBgBNc5Pvl6vk3EwMDAWO8/5NPK8Rf8b2BgYHwUI9/etQF31lSo2w8YGBhbM2ZhtN325UnvylEPDAyM7RhfDb6yUJgpdygAAAAASUVORK5CYII='>
        
          <img src="https://cdn.jsdelivr.net/gh/xaoxuu/assets@19.1.9/logo/128/wechat.png">
        
        </a>
      
    
      
        <a class='qrcode' rel="external nofollow noopener noreferrer" href='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMYAAADGCAAAAACs8KCBAAACLUlEQVR42u3aS27DMAwFwNz/0um2RWvnPcopEHm0MgJ/NFowIqnHIx7Pb+P3L0fj+53nbz76ysUDAwPjYxn5VH5/4Pye9j3tYmFgYNyNkYTCPByfTyIJ5fncMDAwMFpGHnBbEgYGBkbOmKWdK5tLDAwMjLZklkz9qu3gW3JxDAyMD2TkVff/v35LfwMDA+OjGM9ynG/OZtOaNUd/PIWBgbE1Iw9w7XGKlV+GKTEGBsYNGCsHHa6a9Mr7MTAw9mbkBbWVgtf5U3n788XbMDAwtmO0U89T1ny67VJeEGQxMDA+irF+qOJ9z9ZBHwMDY2vGVUlmvr1rWwhFgxMDA2M7xtsz4zj1bWfy4xoDA2NrRh4088Ry1lpom5ovtoYYGBg3YLSF/rZ81i5H0ZbAwMDYjtEepGjvmbUt840jBgbGfRgriehKA2DlnsNcHAMDY1PGenNxFqbb5uVhsMbAwNiaMZtcUkRrm5p5Un34LAYGxtaMpG3ZBs3ZUYwkfL9IazEwMDZlzFLZHD9bsmQp//jfwMDA2JrRPrxe7p81Gx75izAwMLZjzAphs5MdLbXY22JgYGzHeJZjFnDbg2X5kmFgYNyBkY+k9NYe12iLd0XtEAMDYztGHmRn8W2WvuaBGwMD4z6M9cbkbCs5S2IPj4VhYGBgBNc5Pvl6vk3EwMDAWO8/5NPK8Rf8b2BgYHwUI9/etQF31lSo2w8YGBhbM2ZhtN325UnvylEPDAyM7RhfDb6yUJgpdygAAAAASUVORK5CYII='>
        
          <img src="https://cdn.jsdelivr.net/gh/xaoxuu/assets@19.1.9/logo/128/qrcode.png">
        
        </a>
      
    
  </div>
</div>



        
      
    </div>
  </section>


        
        
            <div class="prev-next">
                
                    <section class="prev">
                        <span class="art-item-left">
                            <h6><i class="fas fa-chevron-left" aria-hidden="true"></i>&nbsp;上一页</h6>
                            <h4>
                                <a href="/posts/93532fe.html" rel="prev" title="vue性能优化">
                                  
                                      vue性能优化
                                  
                                </a>
                            </h4>
                            
                                
                                <h6 class="tags">
                                    <a class="tag" href="/blogpost/tags/vue/"><i class="fas fa-hashtag fa-fw" aria-hidden="true"></i>vue</a> <a class="tag" href="/blogpost/tags/性能优化/"><i class="fas fa-hashtag fa-fw" aria-hidden="true"></i>性能优化</a>
                                </h6>
                            
                        </span>
                    </section>
                
                
                    <section class="next">
                        <span class="art-item-right" aria-hidden="true">
                            <h6>下一页&nbsp;<i class="fas fa-chevron-right" aria-hidden="true"></i></h6>
                            <h4>
                                <a href="/posts/d3643a0f.html" rel="prev" title="手写简易版vue，minivue的实现">
                                    
                                        手写简易版vue，minivue的实现
                                    
                                </a>
                            </h4>
                            
                                
                                <h6 class="tags">
                                    <a class="tag" href="/blogpost/tags/vue/"><i class="fas fa-hashtag fa-fw" aria-hidden="true"></i>vue</a>
                                </h6>
                            
                        </span>
                    </section>
                
            </div>
        
      </section>
    </article>
  

  
    <!-- 显示推荐文章和评论 -->



  


  




<!-- 根据页面mathjax变量决定是否加载MathJax数学公式js -->



  <script>
    window.subData = {
      title: 'vue面试题（1）',
      tools: true
    }
  </script>

<!-- gittalk -->

  <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
<div id="gitalk-container" style="margin: 0 5px;"></div>
<script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
<script type="text/javascript">
  var gitalk = new Gitalk({
    clientID: 'c9d3bfe9137dc2038a1a',
    clientSecret: '1ecb6999a152dad80e08c672ac5a779b92eb6ec0',
    id: window.location.pathname,
    repo: 'yangyfeng.github.io',
    owner: 'yangyfeng',
    admin: 'yangyfeng'
  })
  gitalk.render('gitalk-container')
</script>

</div>
<aside class='l_side'>
  
    
    
      
        
          
          
            <section class='widget author'>
  <div class='content material'>
    
      <div class='avatar' style="position: relative;">
        <a style="position: absolute;right: 0;top: 0;z-index: 2" href="https://github.com/yangyfeng" target="_blank" class="github-corner" aria-label="View source on Github">
          <svg width="92" height="92" viewBox="0 0 250 250" style="fill:#151513;color:#fff;position:absolute;top:0;border:0;right:0" aria-hidden="true"><path d="M0 0 115 115 130 115 142 142 250 250 250 0Z"></path><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4L133.7 101.6C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8Z" fill="currentColor" class="octo-body"></path></svg>
        </a>
        <img class='avatar' src='https://s2.ax1x.com/2019/07/12/Zhm4jf.jpg'/>
      </div>
    
    
      <div class='text'>
        
          <h2>漫道求索</h2>
        
        
          <p><span data-chakhsu data-chakhsu-text="每写一行代码，都是人类的一次进步">每写一行代码，都是人类的一次进步</span></p>

        
        
      </div>
    
    
      <div class="social-wrapper">
        
          
            <a href="mailto:yangyufeng.web@foxmail.com"
              class="social fas fa-envelope flat-btn"
              target="_blank"
              rel="external nofollow noopener noreferrer">
            </a>
          
        
          
            <a href="https://segmentfault.com/u/yangyufeng"
              class="social fas fa-link flat-btn"
              target="_blank"
              rel="external nofollow noopener noreferrer">
            </a>
          
        
          
            <a href="https://blog.csdn.net/qq_35676160"
              class="social fa fa-paper-plane flat-btn"
              target="_blank"
              rel="external nofollow noopener noreferrer">
            </a>
          
        
          
            <a href="https://tool.lu/"
              class="social fas fa-toolbox flat-btn"
              target="_blank"
              rel="external nofollow noopener noreferrer">
            </a>
          
        
      </div>
    
  </div>
</section>

          
        
      
        
          
          
            
  <section class='widget toc-wrapper'>
    
<header class='material'>
  <div><i class="fas fa-list fa-fw" aria-hidden="true"></i>&nbsp;&nbsp;本文目录</div>
  
    <div class='wrapper'><a class="s-toc rightBtn" rel="external nofollow noopener noreferrer" href="javascript:void(0)"><i class="fas fa-thumbtack fa-fw"></i></a></div>
  
</header>

    <div class='content material'>
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Vue双向绑定实现原理？"><span class="toc-text">Vue双向绑定实现原理？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Vue-router有几种模式？如何实现呢？"><span class="toc-text">Vue-router有几种模式？如何实现呢？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#vue中keepalive怎么理解？"><span class="toc-text">vue中keepalive怎么理解？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Vue-use中都发生了什么？"><span class="toc-text">Vue.use中都发生了什么？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#简述一下Vue-js的template编译过程？"><span class="toc-text">简述一下Vue.js的template编译过程？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Vue中的nextTick如何理解，它是干什么的？"><span class="toc-text">Vue中的nextTick如何理解，它是干什么的？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#nextTick实现原理"><span class="toc-text">nextTick实现原理?</span></a></li></ol>
    </div>
  </section>


          
        
      
        
          
          
            <section class='widget grid'>
  
<header class='material'>
  <div><i class="fas fa-map-signs fa-fw" aria-hidden="true"></i>&nbsp;&nbsp;站内导航</div>
  
</header>

  <div class='content material'>
    <ul class="grid navgation">
      
        <li><a class="flat-box" title="/" href="/"
          
          
          id="home">
          
            <i class="fas fa-clock fa-fw" aria-hidden="true"></i>
          
          所有文章
        </a></li>
      
        <li><a class="flat-box" title="/blogpost/archives/" href="/blogpost/archives/"
          
            rel="nofollow"
          
          
          id="blogpostarchives">
          
            <i class="fas fa-archive fa-fw" aria-hidden="true"></i>
          
          文章归档
        </a></li>
      
        <li><a class="flat-box" title="/blogpost/tags/" href="/blogpost/tags/"
          
            rel="nofollow"
          
          
          id="blogposttags">
          
            <i class="fas fa-hashtag fa-fw" aria-hidden="true"></i>
          
          所有标签
        </a></li>
      
        <li><a class="flat-box" title="/friends/" href="/friends/"
          
            rel="nofollow"
          
          
          id="friends">
          
            <i class="fas fa-link fa-fw" aria-hidden="true"></i>
          
          我的友链
        </a></li>
      
        <li><a class="flat-box" title="/./atom.xml" href="/./atom.xml"
          
            rel="nofollow"
          
          
          id=".atom.xml">
          
            <i class="fas fa-rss fa-fw" aria-hidden="true"></i>
          
          RSS订阅
        </a></li>
      
        <li><a class="flat-box" title="/about/" href="/about/"
          
            rel="nofollow"
          
          
          id="about">
          
            <i class="fas fa-info-circle fa-fw" aria-hidden="true"></i>
          
          关于博主
        </a></li>
      
    </ul>
  </div>
</section>

          
        
      
        
          
          
            
  <section class='widget category'>
    
<header class='material'>
  <div><i class="fas fa-folder-open fa-fw" aria-hidden="true"></i>&nbsp;&nbsp;文章分类</div>
  
    <a class="rightBtn"
    
      rel="nofollow"
    
    
    href="/blogpost/categories/"
    title="blogpost/categories/">
    <i class="fas fa-expand-arrows-alt fa-fw"></i></a>
  
</header>

    <div class='content material'>
      <ul class="entry">
        
          <li><a class="flat-box" title="/blogpost/categories/Es6/" href="/blogpost/categories/Es6/"><div class='name'>Es6</div><div class='badge'>(2)</div></a></li>
        
          <li><a class="flat-box" title="/blogpost/categories/Git/" href="/blogpost/categories/Git/"><div class='name'>Git</div><div class='badge'>(2)</div></a></li>
        
          <li><a class="flat-box" title="/blogpost/categories/GoLang/" href="/blogpost/categories/GoLang/"><div class='name'>GoLang</div><div class='badge'>(1)</div></a></li>
        
          <li><a class="flat-box" title="/blogpost/categories/Http/" href="/blogpost/categories/Http/"><div class='name'>Http</div><div class='badge'>(2)</div></a></li>
        
          <li><a class="flat-box" title="/blogpost/categories/Node/" href="/blogpost/categories/Node/"><div class='name'>Node</div><div class='badge'>(2)</div></a></li>
        
          <li><a class="flat-box" title="/blogpost/categories/个人项目/" href="/blogpost/categories/个人项目/"><div class='name'>个人项目</div><div class='badge'>(4)</div></a></li>
        
          <li><a class="flat-box" title="/blogpost/categories/前端/" href="/blogpost/categories/前端/"><div class='name'>前端</div><div class='badge'>(20)</div></a></li>
        
          <li><a class="flat-box" title="/blogpost/categories/博客文档/" href="/blogpost/categories/博客文档/"><div class='name'>博客文档</div><div class='badge'>(2)</div></a></li>
        
          <li><a class="flat-box" title="/blogpost/categories/开发工具/" href="/blogpost/categories/开发工具/"><div class='name'>开发工具</div><div class='badge'>(4)</div></a></li>
        
          <li><a class="flat-box" title="/blogpost/categories/深入前端/" href="/blogpost/categories/深入前端/"><div class='name'>深入前端</div><div class='badge'>(8)</div></a></li>
        
      </ul>
    </div>
  </section>


          
        
      
        
          
          
            
  <section class='widget tagcloud'>
    
<header class='material'>
  <div><i class="fas fa-fire fa-fw" aria-hidden="true"></i>&nbsp;&nbsp;热门标签</div>
  
    <a class="rightBtn"
    
      rel="nofollow"
    
    
    href="/blogpost/tags/"
    title="blogpost/tags/">
    <i class="fas fa-expand-arrows-alt fa-fw"></i></a>
  
</header>

    <div class='content material'>
      <a href="/blogpost/tags/JS运行原理/" style="font-size: 18px; color: #7e7e7e">JS运行原理</a> <a href="/blogpost/tags/V8引擎/" style="font-size: 14px; color: #999">V8引擎</a> <a href="/blogpost/tags/create-react-app/" style="font-size: 16px; color: #8b8b8b">create-react-app</a> <a href="/blogpost/tags/devops/" style="font-size: 14px; color: #999">devops</a> <a href="/blogpost/tags/event-loop/" style="font-size: 14px; color: #999">event loop</a> <a href="/blogpost/tags/excel/" style="font-size: 14px; color: #999">excel</a> <a href="/blogpost/tags/for循环/" style="font-size: 14px; color: #999">for循环</a> <a href="/blogpost/tags/git/" style="font-size: 14px; color: #999">git</a> <a href="/blogpost/tags/http/" style="font-size: 14px; color: #999">http</a> <a href="/blogpost/tags/javascript/" style="font-size: 18px; color: #7e7e7e">javascript</a> <a href="/blogpost/tags/less/" style="font-size: 14px; color: #999">less</a> <a href="/blogpost/tags/react/" style="font-size: 16px; color: #8b8b8b">react</a> <a href="/blogpost/tags/tcp/" style="font-size: 14px; color: #999">tcp</a> <a href="/blogpost/tags/vscode/" style="font-size: 16px; color: #8b8b8b">vscode</a> <a href="/blogpost/tags/vue/" style="font-size: 24px; color: #555">vue</a> <a href="/blogpost/tags/webpack/" style="font-size: 16px; color: #8b8b8b">webpack</a> <a href="/blogpost/tags/前端/" style="font-size: 20px; color: #707070">前端</a> <a href="/blogpost/tags/前端工程化/" style="font-size: 20px; color: #707070">前端工程化</a> <a href="/blogpost/tags/开发工具/" style="font-size: 16px; color: #8b8b8b">开发工具</a> <a href="/blogpost/tags/性能优化/" style="font-size: 14px; color: #999">性能优化</a> <a href="/blogpost/tags/插件/" style="font-size: 14px; color: #999">插件</a> <a href="/blogpost/tags/数据可视化/" style="font-size: 20px; color: #707070">数据可视化</a> <a href="/blogpost/tags/模块化/" style="font-size: 14px; color: #999">模块化</a> <a href="/blogpost/tags/浏览器运行原理/" style="font-size: 14px; color: #999">浏览器运行原理</a> <a href="/blogpost/tags/面试题/" style="font-size: 22px; color: #636363">面试题</a>
    </div>
  </section>


          
        
      
        
          
          
            
  <section class='widget related_posts'>
    
<header class='material'>
  <div><i class="fas fa-bookmark fa-fw" aria-hidden="true"></i>&nbsp;&nbsp;相关文章</div>
  
</header>

    <div class="content material">
      <ul class="popular-posts"><li class="popular-posts-item"><div class="popular-posts-title"><h3><a href="\posts\5f998618.html" title="风力发电SCADA" rel="bookmark">风力发电SCADA</a></h3></div></li><li class="popular-posts-item"><div class="popular-posts-title"><h3><a href="\posts\e210f74f.html" title="vue面试题（2）" rel="bookmark">vue面试题（2）</a></h3></div></li><li class="popular-posts-item"><div class="popular-posts-title"><h3><a href="\posts\8136685c.html" title="less在vue中的使用" rel="bookmark">less在vue中的使用</a></h3></div></li><li class="popular-posts-item"><div class="popular-posts-title"><h3><a href="\posts\4de2b0c3.html" title="vue.config.js配置" rel="bookmark">vue.config.js配置</a></h3></div></li><li class="popular-posts-item"><div class="popular-posts-title"><h3><a href="\posts\b0d42301.html" title="vue响应式原理源码剖析" rel="bookmark">vue响应式原理源码剖析</a></h3></div></li><li class="popular-posts-item"><div class="popular-posts-title"><h3><a href="\posts\93532fe.html" title="vue性能优化" rel="bookmark">vue性能优化</a></h3></div></li><li class="popular-posts-item"><div class="popular-posts-title"><h3><a href="\posts\f8a3109a.html" title="webpack依赖加载cdn配置" rel="bookmark">webpack依赖加载cdn配置</a></h3></div></li><li class="popular-posts-item"><div class="popular-posts-title"><h3><a href="\posts\da177769.html" title="vue轮子工厂" rel="bookmark">vue轮子工厂</a></h3></div></li><li class="popular-posts-item"><div class="popular-posts-title"><h3><a href="\posts\a2043eea.html" title="React 脚手架工具（create-react-app）" rel="bookmark">React 脚手架工具（create-react-app）</a></h3></div></li><li class="popular-posts-item"><div class="popular-posts-title"><h3><a href="\posts\6a5e2f06.html" title="create-react-app(注意事项)" rel="bookmark">create-react-app(注意事项)</a></h3></div></li></ul>
    </div>
  </section>


          
        
      
        
          
          
            


  <section class='widget music'>
    
<header class='material'>
  <div><i class="fas fa-compact-disc fa-fw" aria-hidden="true"></i>&nbsp;&nbsp;最近在听</div>
  
    <a class="rightBtn"
    
      rel="external nofollow noopener noreferrer"
    
    
      target="_blank"
    
    href="https://music.163.com/#/user/home?id=629541737"
    title="https://music.163.com/#/user/home?id=629541737">
    <i class="far fa-heart fa-fw"></i></a>
  
</header>

    <div class='content material'>
      
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer@1.7.0/dist/APlayer.min.css">
  <div class="aplayer"
    data-theme="#242424"
    
    
    data-mode="circulation"
    data-server="netease"
    data-type="playlist"
    data-id="2868600326"
    data-volume="0.7">
  </div>
  <script src="https://cdn.jsdelivr.net/npm/aplayer@1.7.0/dist/APlayer.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/meting@1.1.0/dist/Meting.min.js"></script>


    </div>
  </section>


          
        
      
    

  
</aside>

<footer id="footer" class="clearfix">
  
  
    <div class="social-wrapper">
      
        
          <a href="mailto:yangyufeng.web@foxmail.com" class="social fas fa-envelope flat-btn" target="_blank"
            rel="external nofollow noopener noreferrer">
          </a>
        
      
        
          <a href="https://segmentfault.com/u/yangyufeng" class="social fas fa-link flat-btn" target="_blank"
            rel="external nofollow noopener noreferrer">
          </a>
        
      
        
          <a href="https://blog.csdn.net/qq_35676160" class="social fa fa-paper-plane flat-btn" target="_blank"
            rel="external nofollow noopener noreferrer">
          </a>
        
      
        
          <a href="https://tool.lu/" class="social fas fa-toolbox flat-btn" target="_blank"
            rel="external nofollow noopener noreferrer">
          </a>
        
      
    </div>
  
  <!-- 统计 -->
  <div class="total-count">
    <!-- 访问量 -->
    
      <span>
        <b class="fas fa-chart-line"></b>
        总计访问：<span id="busuanzi_value_site_pv"><i class="fas fa-spinner fa-spin fa-fw" aria-hidden="true"></i></span>次
      </span>
    
    <!-- 文章字体个数 -->
    
      <span>
        <b class="fas fa-database"></b>
        本站字数：<span class="post-count">55.5k</span>
      </span>
    
    <!-- 网站运行时间 -->
    <span>
      <b class="fas fa-calendar-day"></b>
      网站运行时间：<span id="timeDate">载入天数...</span><span id="times">载入时分秒...</span>
    </span>
  </div>
</footer>
<script>setLoadingBarProgress(80);</script>
<script>
  var now = new Date();
  function createtime() {
    //在此处修改你的建站时间
    var grt = new Date("07/01/2019 00:00:00");
    now.setTime(now.getTime() + 250);
    days = (now - grt) / 1000 / 60 / 60 / 24; dnum = Math.floor(days);
    hours = (now - grt) / 1000 / 60 / 60 - (24 * dnum); hnum = Math.floor(hours);
    if (String(hnum).length == 1) { hnum = "0" + hnum; } minutes = (now - grt) / 1000 / 60 - (24 * 60 * dnum) - (60 * hnum);
    mnum = Math.floor(minutes); if (String(mnum).length == 1) { mnum = "0" + mnum; }
    seconds = (now - grt) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum);
    snum = Math.round(seconds); if (String(snum).length == 1) { snum = "0" + snum; }
    document.getElementById("timeDate").innerHTML = dnum + " 天 ";
    document.getElementById("times").innerHTML = hnum + " 小时 " + mnum + " 分 " + snum + " 秒";
  }
  setInterval("createtime()", 250);
</script>

      <!-- 会动的小人 -->
      <!-- <div id="spig" class="spig">
        <div id="message">加载中……</div>
        <div id="mumu" class="mumu"></div>
      </div> -->
      <!-- 樱花资源 -->
      <canvas id="sakura"></canvas>
      <script>setLoadingBarProgress(60);</script>
    </div>
    <a class="s-top fas fa-arrow-up fa-fw" href='javascript:void(0)'></a>
  </div>
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/gh/TRHX/CDN-for-itrhx.com@2.0.2/js/instantclick-1.2.2.js" type="module"></script>

  <script>
    var GOOGLE_CUSTOM_SEARCH_API_KEY = "";
    var GOOGLE_CUSTOM_SEARCH_ENGINE_ID = "";
    var ALGOLIA_API_KEY = "";
    var ALGOLIA_APP_ID = "";
    var ALGOLIA_INDEX_NAME = "";
    var AZURE_SERVICE_NAME = "";
    var AZURE_INDEX_NAME = "";
    var AZURE_QUERY_KEY = "";
    var BAIDU_API_ID = "";
    var SEARCH_SERVICE = "hexo" || "hexo";
    var ROOT = "/"||"/";
    if(!ROOT.endsWith('/'))ROOT += '/';
  </script>


  <script async src="https://cdn.jsdelivr.net/npm/scrollreveal@4.0.5/dist/scrollreveal.min.js"></script>
  <script type="text/javascript">
    $(function() {
      const $reveal = $('.reveal');
      if ($reveal.length === 0) return;
      const sr = ScrollReveal({ distance: 0 });
      sr.reveal('.reveal');
    });
  </script>


  <script src="https://cdn.jsdelivr.net/npm/node-waves@0.7.6/dist/waves.min.js"></script>
  <script type="text/javascript">
    $(function() {
      Waves.attach('.flat-btn', ['waves-button']);
      Waves.attach('.float-btn', ['waves-button', 'waves-float']);
      Waves.attach('.float-btn-light', ['waves-button', 'waves-float', 'waves-light']);
      Waves.attach('.flat-box', ['waves-block']);
      Waves.attach('.float-box', ['waves-block', 'waves-float']);
      Waves.attach('.waves-image');
      Waves.init();
    });
  </script>


  <script async src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-busuanzi@2.3/js/busuanzi.pure.mini.js"></script>


  <!-- fastclick -->
  <script src="https://cdn.jsdelivr.net/npm/fastclick@1.0.6/lib/fastclick.min.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      FastClick.attach(document.body)
    }, false)
  </script>



  
  
  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-backstretch/2.0.4/jquery.backstretch.min.js"></script>
    <script type="text/javascript">
      $(function(){
        if ('.cover') {
          $('.cover').backstretch(
          ["https://cdn.jsdelivr.net/gh/yangyfeng/yangyfeng.github.io@gh-pages/assets_blog/img/gb3.jpg"],
          {
            duration: "60000",
            fade: "1000"
          });
        } else {
          $.backstretch(
          ["https://cdn.jsdelivr.net/gh/yangyfeng/yangyfeng.github.io@gh-pages/assets_blog/img/gb3.jpg"],
          {
            duration: "60000",
            fade: "1000"
          });
        }
      });
    </script>
  











  <script src="https://cdn.jsdelivr.net/gh/yangyfeng/yangyfeng.github.io@gh-pages/assets_blog/js/app.js"></script>


  <script src="https://cdn.jsdelivr.net/gh/yangyfeng/yangyfeng.github.io@gh-pages/assets_blog/js/search.js"></script>




<!-- 复制 -->
<script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script>
<script>
  let COPY_SUCCESS = "复制成功";
  let COPY_FAILURE = "复制失败";
  /*页面载入完成后，创建复制按钮*/
  !function (e, t, a) {
    /* code */
    var initCopyCode = function(){
      var copyHtml = '';
      copyHtml += '<button class="btn-copy" data-clipboard-snippet="">';
      copyHtml += '  <i class="fa fa-copy"></i><span>复制</span>';
      copyHtml += '</button>';
      $(".highlight .code pre").before(copyHtml);
      var clipboard = new ClipboardJS('.btn-copy', {
        target: function(trigger) {
          return trigger.nextElementSibling;
        }
      });

      clipboard.on('success', function(e) {
        //您可以加入成功提示
        console.info('Action:', e.action);
        console.info('Text:', e.text);
        console.info('Trigger:', e.trigger);
        success_prompt(COPY_SUCCESS);
        e.clearSelection();
      });
      clipboard.on('error', function(e) {
        //您可以加入失败提示
        console.error('Action:', e.action);
        console.error('Trigger:', e.trigger);
        fail_prompt(COPY_FAILURE);
      });
    }
    initCopyCode();

  }(window, document);

  /**
   * 弹出式提示框，默认1.5秒自动消失
   * @param message 提示信息
   * @param style 提示样式，有alert-success、alert-danger、alert-warning、alert-info
   * @param time 消失时间
   */
  var prompt = function (message, style, time)
  {
      style = (style === undefined) ? 'alert-success' : style;
      time = (time === undefined) ? 1500 : time*1000;
      $('<div>')
          .appendTo('body')
          .addClass('alert ' + style)
          .html(message)
          .show()
          .delay(time)
          .fadeOut();
  };

  // 成功提示
  var success_prompt = function(message, time)
  {
      prompt(message, 'alert-success', time);
  };

  // 失败提示
  var fail_prompt = function(message, time)
  {
      prompt(message, 'alert-danger', time);
  };

  // 提醒
  var warning_prompt = function(message, time)
  {
      prompt(message, 'alert-warning', time);
  };

  // 信息提示
  var info_prompt = function(message, time)
  {
      prompt(message, 'alert-info', time);
  };

</script>


<!-- fancybox -->
<script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>
<script>
  let LAZY_LOAD_IMAGE = "[object Object]";
  $(".article-entry").find("fancybox").find("img").each(function () {
      var element = document.createElement("a");
      $(element).attr("data-fancybox", "gallery");
      $(element).attr("href", $(this).attr("src"));
      /* 图片采用懒加载处理时,
       * 一般图片标签内会有个属性名来存放图片的真实地址，比如 data-original,
       * 那么此处将原本的属性名src替换为对应属性名data-original,
       * 修改如下
       */
       if (LAZY_LOAD_IMAGE) {
         $(element).attr("href", $(this).attr("data-original"));
       }
      $(this).wrap(element);
  });
</script>





  <script>setLoadingBarProgress(100);</script>
  <!-- 浮动小人 -->
  <!-- <script type="text/javascript" src="https://cdn.jsdelivr.net/gh/yangyfeng/yangyfeng.github.io@gh-pages/assets_blog/js/sipng.js"></script> -->
  <!-- 页面点击小红心 -->
  <!-- <script type="text/javascript" src="https://cdn.jsdelivr.net/gh/yangyfeng/yangyfeng.github.io@gh-pages/assets_blog/js/love.js"></script> -->
  <!--动态线条背景-->
  <script type="text/javascript" src="https://cdn.jsdelivr.net/gh/yangyfeng/yangyfeng.github.io@gh-pages/assets_blog/js/canvas-nest.min.js" color="111,111,111" opacity='0.65' zIndex="-10" count="120" ></script>
  <!-- 飘动丝带 -->
  <script type="text/javascript" src="https://cdn.jsdelivr.net/gh/yangyfeng/yangyfeng.github.io@gh-pages/assets_blog/js/piao.js" ></script>
  <!-- 跳动的字 -->
  <script type="text/javascript" src="https://cdn.jsdelivr.net/gh/yangyfeng/yangyfeng.github.io@gh-pages/assets_blog/js/chakhsu.js" ></script>
  <!-- 樱花飘落 -->
  <!-- <script type="text/javascript" src="https://cdn.jsdelivr.net/gh/yangyfeng/yangyfeng.github.io@gh-pages/assets_blog/js/sakura.js" ></script> -->
  <!-- 人体时钟背景透明 -->
  <!-- <script type="text/javascript" charset="Shift_JIS" src="https://cdn.jsdelivr.net/gh/yangyfeng/yangyfeng.github.io@gh-pages/assets_blog/js/clock.js"></script> -->
  <!-- 浏览器搞笑标题 -->
  <script type="text/javascript" id="bowerTitle">
    var OriginTitle = document.title;
    var titleTime;
    document.addEventListener('visibilitychange', function () {
      if (document.hidden) {
        $('[rel="shortcut icon"]').attr('href', "https://cdn.jsdelivr.net/gh/yangyfeng/yangyfeng.github.io@gh-pages/assets_blog/img/error_favicon.ico");
        document.title = '你的页面走丢了...';
        clearTimeout(titleTime);
      } else {
        $('[rel="shortcut icon"]').attr('href', "https://cdn.jsdelivr.net/gh/yangyfeng/yangyfeng.github.io@gh-pages/assets_blog/img/favicon.ico");
        document.title = '欢迎回来!'
        titleTime = setTimeout(function () {
          document.title = OriginTitle;
        }, 1000)
      }
    });
  </script>
  <!-- 樱花资源 -->
  <script id="sakura_point_vsh" type="x-shader/x_vertex">
    uniform mat4 uProjection;
    uniform mat4 uModelview;
    uniform vec3 uResolution;
    uniform vec3 uOffset;
    uniform vec3 uDOF;  //x:focus distance, y:focus radius, z:max radius
    uniform vec3 uFade; //x:start distance, y:half distance, z:near fade start
    
    attribute vec3 aPosition;
    attribute vec3 aEuler;
    attribute vec2 aMisc; //x:size, y:fade
    
    varying vec3 pposition;
    varying float psize;
    varying float palpha;
    varying float pdist;
    
    //varying mat3 rotMat;
    varying vec3 normX;
    varying vec3 normY;
    varying vec3 normZ;
    varying vec3 normal;
    
    varying float diffuse;
    varying float specular;
    varying float rstop;
    varying float distancefade;
    
    void main(void) {
    // Projection is based on vertical angle
    vec4 pos = uModelview * vec4(aPosition + uOffset, 1.0);
    gl_Position = uProjection * pos;
    gl_PointSize = aMisc.x * uProjection[1][1] / -pos.z * uResolution.y * 0.5;
    
    pposition = pos.xyz;
    psize = aMisc.x;
    pdist = length(pos.xyz);
    palpha = smoothstep(0.0, 1.0, (pdist - 0.1) / uFade.z);
    
    vec3 elrsn = sin(aEuler);
    vec3 elrcs = cos(aEuler);
    mat3 rotx = mat3(
    1.0, 0.0, 0.0,
    0.0, elrcs.x, elrsn.x,
    0.0, -elrsn.x, elrcs.x
    );
    mat3 roty = mat3(
    elrcs.y, 0.0, -elrsn.y,
    0.0, 1.0, 0.0,
    elrsn.y, 0.0, elrcs.y
    );
    mat3 rotz = mat3(
    elrcs.z, elrsn.z, 0.0, 
    -elrsn.z, elrcs.z, 0.0,
    0.0, 0.0, 1.0
    );
    mat3 rotmat = rotx * roty * rotz;
    normal = rotmat[2];
    
    mat3 trrotm = mat3(
    rotmat[0][0], rotmat[1][0], rotmat[2][0],
    rotmat[0][1], rotmat[1][1], rotmat[2][1],
    rotmat[0][2], rotmat[1][2], rotmat[2][2]
    );
    normX = trrotm[0];
    normY = trrotm[1];
    normZ = trrotm[2];
    
    const vec3 lit = vec3(0.6917144638660746, 0.6917144638660746, -0.20751433915982237);
    
    float tmpdfs = dot(lit, normal);
    if(tmpdfs < 0.0) {
    normal = -normal;
    tmpdfs = dot(lit, normal);
    }
    diffuse = 0.4 + tmpdfs;
    
    vec3 eyev = normalize(-pos.xyz);
    if(dot(eyev, normal) > 0.0) {
    vec3 hv = normalize(eyev + lit);
    specular = pow(max(dot(hv, normal), 0.0), 20.0);
    }
    else {
    specular = 0.0;
    }
    
    rstop = clamp((abs(pdist - uDOF.x) - uDOF.y) / uDOF.z, 0.0, 1.0);
    rstop = pow(rstop, 0.5);
    //-0.69315 = ln(0.5)
    distancefade = min(1.0, exp((uFade.x - pdist) * 0.69315 / uFade.y));
    }
  </script>
  <script id="sakura_point_fsh" type="x-shader/x_fragment">
    #ifdef GL_ES
    //precision mediump float;
    precision highp float;
    #endif
    
    uniform vec3 uDOF;  //x:focus distance, y:focus radius, z:max radius
    uniform vec3 uFade; //x:start distance, y:half distance, z:near fade start
    
    const vec3 fadeCol = vec3(0.08, 0.03, 0.06);
    
    varying vec3 pposition;
    varying float psize;
    varying float palpha;
    varying float pdist;
    
    //varying mat3 rotMat;
    varying vec3 normX;
    varying vec3 normY;
    varying vec3 normZ;
    varying vec3 normal;
    
    varying float diffuse;
    varying float specular;
    varying float rstop;
    varying float distancefade;
    
    float ellipse(vec2 p, vec2 o, vec2 r) {
    vec2 lp = (p - o) / r;
    return length(lp) - 1.0;
    }
    
    void main(void) {
    vec3 p = vec3(gl_PointCoord - vec2(0.5, 0.5), 0.0) * 2.0;
    vec3 d = vec3(0.0, 0.0, -1.0);
    float nd = normZ.z; //dot(-normZ, d);
    if(abs(nd) < 0.0001) discard;
    
    float np = dot(normZ, p);
    vec3 tp = p + d * np / nd;
    vec2 coord = vec2(dot(normX, tp), dot(normY, tp));
    
    //angle = 15 degree
    const float flwrsn = 0.258819045102521;
    const float flwrcs = 0.965925826289068;
    mat2 flwrm = mat2(flwrcs, -flwrsn, flwrsn, flwrcs);
    vec2 flwrp = vec2(abs(coord.x), coord.y) * flwrm;
    
    float r;
    if(flwrp.x < 0.0) {
    r = ellipse(flwrp, vec2(0.065, 0.024) * 0.5, vec2(0.36, 0.96) * 0.5);
    }
    else {
    r = ellipse(flwrp, vec2(0.065, 0.024) * 0.5, vec2(0.58, 0.96) * 0.5);
    }
    
    if(r > rstop) discard;
    
    vec3 col = mix(vec3(1.0, 0.8, 0.75), vec3(1.0, 0.9, 0.87), r);
    float grady = mix(0.0, 1.0, pow(coord.y * 0.5 + 0.5, 0.35));
    col *= vec3(1.0, grady, grady);
    col *= mix(0.8, 1.0, pow(abs(coord.x), 0.3));
    col = col * diffuse + specular;
    
    col = mix(fadeCol, col, distancefade);
    
    float alpha = (rstop > 0.001)? (0.5 - r / (rstop * 2.0)) : 1.0;
    alpha = smoothstep(0.0, 1.0, alpha) * palpha;
    
    gl_FragColor = vec4(col * 0.5, alpha);
    }
  </script>
  <!-- effects -->
  <script id="fx_common_vsh" type="x-shader/x_vertex">
    uniform vec3 uResolution;
    attribute vec2 aPosition;
    
    varying vec2 texCoord;
    varying vec2 screenCoord;
    
    void main(void) {
    gl_Position = vec4(aPosition, 0.0, 1.0);
    texCoord = aPosition.xy * 0.5 + vec2(0.5, 0.5);
    screenCoord = aPosition.xy * vec2(uResolution.z, 1.0);
    }
  </script>
  <script id="bg_fsh" type="x-shader/x_fragment">
    #ifdef GL_ES
    //precision mediump float;
    precision highp float;
    #endif
    
    uniform vec2 uTimes;
    
    varying vec2 texCoord;
    varying vec2 screenCoord;
    
    void main(void) {
    vec3 col;
    float c;
    vec2 tmpv = texCoord * vec2(0.8, 1.0) - vec2(0.95, 1.0);
    c = exp(-pow(length(tmpv) * 1.8, 2.0));
    col = mix(vec3(0.02, 0.0, 0.03), vec3(0.96, 0.98, 1.0) * 1.5, c);
    gl_FragColor = vec4(col * 0.5, 1.0);
    }
  </script>
  <script id="fx_brightbuf_fsh" type="x-shader/x_fragment">
    #ifdef GL_ES
    //precision mediump float;
    precision highp float;
    #endif
    uniform sampler2D uSrc;
    uniform vec2 uDelta;
    
    varying vec2 texCoord;
    varying vec2 screenCoord;
    
    void main(void) {
    vec4 col = texture2D(uSrc, texCoord);
    gl_FragColor = vec4(col.rgb * 2.0 - vec3(0.5), 1.0);
    }
  </script>
  <script id="fx_dirblur_r4_fsh" type="x-shader/x_fragment">
    #ifdef GL_ES
    //precision mediump float;
    precision highp float;
    #endif
    uniform sampler2D uSrc;
    uniform vec2 uDelta;
    uniform vec4 uBlurDir; //dir(x, y), stride(z, w)
    
    varying vec2 texCoord;
    varying vec2 screenCoord;
    
    void main(void) {
    vec4 col = texture2D(uSrc, texCoord);
    col = col + texture2D(uSrc, texCoord + uBlurDir.xy * uDelta);
    col = col + texture2D(uSrc, texCoord - uBlurDir.xy * uDelta);
    col = col + texture2D(uSrc, texCoord + (uBlurDir.xy + uBlurDir.zw) * uDelta);
    col = col + texture2D(uSrc, texCoord - (uBlurDir.xy + uBlurDir.zw) * uDelta);
    gl_FragColor = col / 5.0;
    }
  </script>
  <!-- effect fragment shader template -->
  <script id="fx_common_fsh" type="x-shader/x_fragment">
    #ifdef GL_ES
    //precision mediump float;
    precision highp float;
    #endif
    uniform sampler2D uSrc;
    uniform vec2 uDelta;
    
    varying vec2 texCoord;
    varying vec2 screenCoord;
    
    void main(void) {
    gl_FragColor = texture2D(uSrc, texCoord);
    }
  </script>
  <!-- post processing -->
  <script id="pp_final_vsh" type="x-shader/x_vertex">
    uniform vec3 uResolution;
    attribute vec2 aPosition;
    varying vec2 texCoord;
    varying vec2 screenCoord;
    void main(void) {
    gl_Position = vec4(aPosition, 0.0, 1.0);
    texCoord = aPosition.xy * 0.5 + vec2(0.5, 0.5);
    screenCoord = aPosition.xy * vec2(uResolution.z, 1.0);
    }
  </script>
  <script id="pp_final_fsh" type="x-shader/x_fragment">
    #ifdef GL_ES
    //precision mediump float;
    precision highp float;
    #endif
    uniform sampler2D uSrc;
    uniform sampler2D uBloom;
    uniform vec2 uDelta;
    varying vec2 texCoord;
    varying vec2 screenCoord;
    void main(void) {
    vec4 srccol = texture2D(uSrc, texCoord) * 2.0;
    vec4 bloomcol = texture2D(uBloom, texCoord);
    vec4 col;
    col = srccol + bloomcol * (vec4(1.0) + srccol);
    col *= smoothstep(1.0, 0.0, pow(length((texCoord - vec2(0.5)) * 2.0), 1.2) * 0.5);
    col = pow(col, vec4(0.45454545454545)); //(1.0 / 2.2)
    
    gl_FragColor = vec4(col.rgb, 1.0);
    gl_FragColor.a = 1.0;
    }
  </script>
<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/shizuku.model.json"},"display":{"position":"left","width":100,"height":200},"mobile":{"show":false,"scale":0.7},"log":false});</script><script>!function(e){var r=Array.prototype.slice.call(document.querySelectorAll("img[data-original]"));function t(){for(var c=0;c<r.length;c++)t=r[c],void 0,0<=(n=t.getBoundingClientRect()).top&&0<=n.left&&n.top<=(e.innerHeight||document.documentElement.clientHeight)&&function(){var t,n,e,i,o=r[c];t=o,n=function(){r=r.filter(function(t){return o!==t})},e=new Image,i=t.getAttribute("data-original"),e.onload=function(){t.src=i,n&&n()},e.src=i}();var t,n}t(),e.addEventListener("scroll",function(){!function(t,n){clearTimeout(t.tId),t.tId=setTimeout(function(){t.call(n)},500)}(t,e)})}(this);</script></body>
</html>
